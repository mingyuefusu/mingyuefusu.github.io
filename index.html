<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>明月复苏-博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="明月复苏-博客">
<meta property="og:url" content="https://mingyuefusu.github.io/index.html">
<meta property="og:site_name" content="明月复苏-博客">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="mingyue">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="明月复苏-博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.0"><link rel="stylesheet" href="/css/prism.css" type="text/css"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">明月复苏-博客</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://mingyuefusu.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-jsp" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/05/14/jsp/" class="article-date">
  <time datetime="2020-05-14T08:39:33.568Z" itemprop="datePublished">2020-05-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/05/14/jsp/">jsp</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="一、web技术介绍"><a href="#一、web技术介绍" class="headerlink" title="一、web技术介绍"></a>一、web技术介绍</h1><h2 id="jsp介绍："><a href="#jsp介绍：" class="headerlink" title="jsp介绍："></a>jsp介绍：</h2><ul>
<li>一种动态网页技术标准，</li>
</ul>
<h3 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h3><p>jsp-&gt;java(servel)-&gt;class</p>
<h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h3><p>跨平台，动静分离，可重用组件，继承servlet，预编译</p>
<h3 id="jsp工作原理"><a href="#jsp工作原理" class="headerlink" title="jsp工作原理"></a>jsp工作原理</h3><p><img src="C:%5CUsers%5CMingYue%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200319112148058.png" alt="image-20200319112148058" loading="lazy"></p>
<p>（1）     客户端（如IE浏览器）向服务器（如Tomcat）发出请求（Request）。</p>
<p>（2）     JSP服务器（如Tomcat）将JSP翻译成Servlet源代码（即.java代码）。</p>
<p>（3）     将产生的Java代码进行编译，使之成为.class文件，将.class文件加载到内存执行。</p>
<p>（4）     把执行结果（标准的HTML文本）作为响应（Response）发送至客户端由浏览器解释显示。</p>
<h3 id="JSP开发方式"><a href="#JSP开发方式" class="headerlink" title="JSP开发方式"></a>JSP开发方式</h3><p><img src="C:%5CUsers%5CMingYue%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200319112218270.png" alt="image-20200319112218270" loading="lazy">·</p>
<h1 id=""><a href="#" class="headerlink" title=""></a></h1><h1 id="二、基础知识"><a href="#二、基础知识" class="headerlink" title="二、基础知识"></a>二、基础知识</h1><h2 id="URI"><a href="#URI" class="headerlink" title="URI"></a>URI</h2><p>定位符</p>
<p>资源符</p>
<p>其中uri表示标签描述符</p>
<p>URI，通一<strong>资源标志符</strong>(Uniform Resource Identifier， URI)，表示的是web上每一种可用的资源，如 HTML文档、图像、视频片段、程序等都由一个URI进行定位的。</p>
<p>&lt;2&gt;URI的结构组成</p>
<p>URI通常由三部分组成：</p>
<p>①访问资源的命名机制；</p>
<p>②存放资源的主机名；</p>
<p>③资源自身的名称。</p>
<p>&lt;3&gt;URI举例</p>
<p>如：<a href="https://blog.csdn.net/qq_32595453/article/details/79516787" target="_blank" rel="noopener">https://blog.csdn.net/qq_32595453/article/details/79516787</a></p>
<p>我们可以这样解释它：</p>
<p>①这是一个可以通过https协议访问的资源，</p>
<p>②位于主机 blog.csdn.net上，</p>
<p>③通过“/qq_32595453/article/details/79516787”可以对该资源进行唯一标识（注意，这个不一定是完整的路径）</p>
<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><strong>URL</strong>是URI的一个子集。它是Uniform Resource Locator的缩写，译为“统一资源定位 符”。</p>
<p>通俗地说，URL是Internet上描述信息资源的字符串，主要用在各种WWW客户程序和服务器程序上。</p>
<p>采用URL可以用一种统一的格式来描述各种信息资源，包括文件、服务器的地址和目录等。URL是URI概念的一种实现方式。</p>
<p>protocol :// hostname[:port] / path / [;parameters][?query]#fragment</p>
<p>①第一部分是协议(或称为服务方式)。</p>
<p>②第二部分是存有该资源的主机IP地址(有时也包括端口号)。</p>
<p>③第三部分是主机资源的具体地址，如目录和文件名等。</p>
<h2 id="2-1隐藏注释"><a href="#2-1隐藏注释" class="headerlink" title="2.1隐藏注释"></a>2.1隐藏注释</h2><ul>
<li><p>&lt;%– comment –%&gt;</p>
</li>
<li><p>&lt;!– 注释还可以使用java语句–&gt;</p>
</li>
<li><p>&lt;%//啥都看不到%&gt;</p>
</li>
</ul>
<h2 id="2-2-脚本元素"><a href="#2-2-脚本元素" class="headerlink" title="2.2 脚本元素"></a>2.2 脚本元素</h2><h3 id="变量声明"><a href="#变量声明" class="headerlink" title="变量声明"></a>变量声明</h3><p><strong>全局变量、定义方法</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;%!	</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">int</span> a = <span class="number">10</span>; </span><br><span class="line"><span class="keyword">public</span> String name;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    name=<span class="string">"ming"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<h3 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h3><p>&lt;%= “shuchu”+expression+””将其输出”” %&gt;</p>
<h3 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h3><p>&lt;% 所有java语法 %&gt;</p>
<h2 id="2-3-常用指令"><a href="#2-3-常用指令" class="headerlink" title="2.3 常用指令"></a>2.3 常用指令</h2><p>&lt;%@ %&gt;</p>
<h3 id="page指令"><a href="#page指令" class="headerlink" title="page指令"></a>page指令</h3><p>&lt;%@page language=”java” import=”java.util.Date”%&gt;</p>
<p>&lt;%@page contentType=”text/html” pageEconding=”UTF-8”%&gt;</p>
<ul>
<li><p>contentType浏览器解析编码 </p>
</li>
<li><p>pageEconding 文件自身编码</p>
</li>
</ul>
<img src="C:\Users\MingYue\AppData\Roaming\Typora\typora-user-images\image-20200320203042406.png" alt="image-20200320203042406" style="zoom:67%;" / loading="lazy">

<h3 id="taglib指令"><a href="#taglib指令" class="headerlink" title="taglib指令"></a>taglib指令</h3><p>&lt;%@taglib uri=”<a href="http://java.sun.com/jsp/jstl/core&quot;" target="_blank" rel="noopener">http://java.sun.com/jsp/jstl/core&quot;</a> prefix=”c”%&gt;</p>
<p>&lt;c:out value-“输出语句”&lt;/c:out&gt;</p>
<h3 id="include指令"><a href="#include指令" class="headerlink" title="include指令"></a>include指令</h3><p>两个界面合二为一</p>
<p>&lt;%@ include file=”fliename” %&gt;</p>
<h2 id="2-4-JSP常用动作"><a href="#2-4-JSP常用动作" class="headerlink" title="2.4 JSP常用动作"></a>2.4 JSP常用动作</h2><h3 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h3><p>在客户端请求jsp页面时，利用jsp动作可以传递参数、动态的插入文件、重用javabean组件、把用户重定向到另外的页面</p>
<h3 id="lt-jsp-param-gt"><a href="#lt-jsp-param-gt" class="headerlink" title="&lt;jsp:param&gt;"></a>&lt;jsp:param&gt;</h3><p><strong>简介</strong></p>
<p>可以用于&lt;jsp:include&gt;、&lt;jsp:forward&gt;和&lt;jsp:plugin&gt;动作体重，为其他动作提供附加信息</p>
<p><strong>语法</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">jsp:param</span> <span class="attr">name</span>=<span class="string">"paramName"</span> <span class="attr">value</span>=<span class="string">"param Value"</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">	name属性用于指定参数名称、不接受动态值</span></span><br><span class="line"><span class="comment">	value属性用于指定参数值，可以接受动态值</span></span><br><span class="line"><span class="comment">!--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%=request.getParameter("Xname")%</span>&gt;</span><span class="tag">&lt;/<span class="name">%</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="六大动作："><a href="#六大动作：" class="headerlink" title="六大动作："></a>六大动作：</h3><p>&lt;jsp:include&gt;&lt;jsp:useBean&gt;&lt;jsp:setProperty&gt;&lt;jsp:getProperty&gt;&lt;jsp:plugin/&gt;&lt;jsp:forward&gt;</p>
<h3 id="lt-jsp-include-gt"><a href="#lt-jsp-include-gt" class="headerlink" title="&lt;jsp:include&gt;"></a>&lt;jsp:include&gt;</h3><p><strong>简介</strong></p>
<p>把指定文件插入正在生成的页面中，会生成两个class文件</p>
<p><strong>语法</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">jsp:include</span> <span class="attr">page</span>=<span class="string">"relatibe URL"</span> <span class="attr">flush</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">jsp:include</span>&gt;</span></span><br><span class="line">或者</span><br><span class="line"><span class="tag">&lt;<span class="name">jsp:include</span> <span class="attr">page</span>=<span class="string">"fileName"</span> <span class="attr">flush</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">jsp:param</span> <span class="attr">name</span>=<span class="string">"paramName"</span> <span class="attr">value</span>=<span class="string">"param Value"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">jsp:include</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	page属性指定资源的相对路径，接受动态值</span><br><span class="line">	flush属性指定包含在目标资源之前是否刷新输出缓冲区，默认为false，不接受动态值</span><br></pre></td></tr></table></figure>

<p><strong>与include对比</strong></p>
<table>
<thead>
<tr>
<th></th>
<th>特点</th>
</tr>
</thead>
<tbody><tr>
<td>&lt;%@include file=”文件名”%&gt;</td>
<td>JSP页面转换为servlet之前插入代码</td>
</tr>
<tr>
<td>&lt;jsp:include page=”文件名”  flush=”true”&gt;</td>
<td>主页面被请求时，将其他页面的输出包含进来</td>
</tr>
<tr>
<td>区别</td>
<td>调用时间不同，&lt;jsp:include&gt;动作在请求期间，include在页面转换期间</td>
</tr>
<tr>
<td>结论</td>
<td>include指令执行时将被导入页面的p代码完全融入,两个页面融合成一个 Servlet;<br>    &lt;jsp: include&gt;动作则在 Servlet中使用 include方法来结论引入被导入页面的内容<br>因此 Include指令执行时不需编译,速度快;&lt;jsp: include&gt;动作需要加载执行,速度慢</td>
</tr>
</tbody></table>
<h3 id="lt-jsp-useBean-gt"><a href="#lt-jsp-useBean-gt" class="headerlink" title="&lt;jsp:useBean/&gt;"></a>&lt;jsp:useBean/&gt;</h3><p><strong>作用</strong></p>
<p>装载一个将在JSP页面中使用的javaBean，实现JavaBean组件重用</p>
<p><strong>语法</strong></p>
<p>&lt;jsp:userBean id=”beanInstanceName” scope=”page | request | session | application” class=”package.class” type=”package.class” beanName=”package.class”/&gt;</p>
<ul>
<li>id ：指定JavaBean实例名称，不接受动态值，如果找到id和scope相同的备案实例，将使用</li>
<li>scope：指定bean作用域范围，不接受动态值<ul>
<li>page：默认，在当前页面有效</li>
<li>request：在当前客户请求内有效</li>
<li>session：在当前httpSession内（会话作用域）</li>
<li>application：在任何相同的application的JSP页面都有效，整个应用程序范围内</li>
</ul>
</li>
<li>class：指定bean的类路径和类名，不接受动态值，不能是抽象的</li>
<li>type：指定应用该对象的变量的类型，必须是bean类的名字、超类名字、该类所实现的接口名称之一。变量的名字由id属性指定</li>
<li>beanName：指定bean的名字，接受动态值，beanName属性必须与type属性结合使用，不能与class同时使用</li>
</ul>
<p><strong>例子</strong></p>
<p>&lt;jsp:useBean id=”time” class=”java.util.Date”/&gt;</p>
<p>&lt;%=time %&gt;</p>
<p>或者</p>
<p>&lt;jsp:useBean id=”time”type=”java. io. Serializable”  beanName=”java util. Date”/&gt;</p>
<h3 id="lt-jsp-setProperty-gt"><a href="#lt-jsp-setProperty-gt" class="headerlink" title="&lt;jsp:setProperty/&gt;"></a>&lt;jsp:setProperty/&gt;</h3><p><strong>作用</strong></p>
<p>用来设置、修改已经实例化的bean中的属性值</p>
<p><strong>语法</strong></p>
<p>&lt;jsp:setProperty name=”beanInstanceName” property=”*”|property=”propertyName” [param=”parameterName” | value =”value”]/&gt;</p>
<ol>
<li><p>name属性:必需。它表示要设置哪个Bean的属性,不可接受动态值。</p>
</li>
<li><p>property属性:必需。它表示要设置哪个属性。如果 property的值是<br>表示所有名字和Bean属性名字匹配的请求参数都将被传递给相<br>应属性的set方法。</p>
</li>
<li><p>param属性:可选。它指定用哪个请求参数作为Bean属性的值。如果当<br>前请求没有参数,则什么事情也不做,系统不会把null传递给Bean属性<br>的set方法。因此,可以让Bean自己提供默认属性值,只有当请求参数<br>明确指定了新值时才修改默认属性值。</p>
</li>
<li><p>value属性:可选。该属性用来指定Bean属性的值。</p>
</li>
</ol>
<h3 id="lt-jsp-getProperty-gt"><a href="#lt-jsp-getProperty-gt" class="headerlink" title="&lt;jsp:getProperty/&gt;"></a>&lt;jsp:getProperty/&gt;</h3><p><strong>作用</strong></p>
<p>获取指定Bean属性的值，转换成字符串，然后输出</p>
<p><strong>语法</strong></p>
<p>&lt;jsp:getProperty name=”beanInstanceName” property=”property”/&gt;</p>
<p>name: 要获取属性的Bean的名称，不接受动态</p>
<p>property：指定要获取的Bean属性名，不接受动态</p>
<h3 id="lt-jsp-forward-gt"><a href="#lt-jsp-forward-gt" class="headerlink" title="&lt;jsp:forward/&gt;"></a>&lt;jsp:forward/&gt;</h3><p><strong>作用</strong></p>
<p>引导客户端的请求到另一个页面或另一个Servlet,只能跳转本网站的</p>
<p>==&lt;jsp:forward&gt;动作只能在本网站内转向，而response对象的sendRedirect()方法可以转跳到任何页面。==</p>
<p><strong>语法</strong></p>
<p>&lt;jsp:forward page=”relativeUrL” /&gt;</p>
<p>可以包含多个&lt;jsp:param&gt;子动作，用于向要引导进入的界面传递参数，当&lt;jsp:forward&gt;动作发生时，如果已经有文本写入输出流，而页面没有设置缓冲，则会抛出异常</p>
<h3 id="lt-jsp-plugin-gt"><a href="#lt-jsp-plugin-gt" class="headerlink" title="&lt;jsp:plugin/&gt;"></a>&lt;jsp:plugin/&gt;</h3><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ol>
<li><p>useBean类中使用getLoginName()方法接受数据，使用setLoginname传出数据，使用时，使用&lt;jsp:useBean&gt;的new对象名id，&lt;jsp:setProperty&gt;通过name对象的setX()方法给X赋值,&lt;jsp:getProperty&gt;通过name对象的getX()方法输出X</p>
</li>
<li><p>通过<strong>request.getParameter(“username”)</strong>直接获取post过来的值，再通过</p>
<p><code>&lt;jsp:forward page=&quot;success.jsp&quot;&gt;</code></p>
<p><code>&lt;jsp:param name=&quot;user&quot; value=&quot;&lt;%=name%&gt;&quot;/&gt;</code></p>
<p><code>&lt;/jsp:forward&gt;</code>跳转</p>
</li>
</ol>
<h3 id="-1"><a href="#-1" class="headerlink" title=""></a></h3><h1 id="三、eclipse设置"><a href="#三、eclipse设置" class="headerlink" title="三、eclipse设置"></a>三、eclipse设置</h1><h2 id="默认编码"><a href="#默认编码" class="headerlink" title="默认编码"></a>默认编码</h2><p>1.打开eclipse,找到windows–&gt;preference。 </p>
<p>2.进入preference后点击Web。 </p>
<p>3.在Web下选择jsp files。 </p>
<p>4.在右边找到encoding修改为自己希望的编码。 </p>
<p><img src="http://yanxuan.nosdn.127.net/bbb8081688dde09c97df45400dbddc29.png" alt="UTOOLS1589439621397.png" loading="lazy"></p>
<p><img src="http://yanxuan.nosdn.127.net/3a286363cd545c825f527bb20c44d7e3.png" alt="UTOOLS1589439633331.png" loading="lazy"></p>
<p><img src="http://yanxuan.nosdn.127.net/907d60aba6895f731a9c8741b3c05d3e.png" alt="UTOOLS1589439643665.png" loading="lazy"></p>
<ul>
<li>tomcat7<ul>
<li>get: <ul>
<li>修改server.xml,更改默认get方式的编码（服务器托管模式,双击服务器),在端口列添加URIEncoding=”UTF-8”</li>
<li>name = new String(name.getBytes(“iso-8859-1”), “utf-8”);</li>
</ul>
</li>
<li>post:   request.setCharacterEncoding(“utf-8”);</li>
</ul>
</li>
</ul>
<h2 id="报错"><a href="#报错" class="headerlink" title="报错"></a>报错</h2><h3 id="tomcat"><a href="#tomcat" class="headerlink" title="tomcat"></a>tomcat</h3><p>好像要先运行java程序才能设置</p>
<p><img src="http://yanxuan.nosdn.127.net/5f8485526dd063051fd1fc365ac43416.png" alt="UTOOLS1589435761739.png" loading="lazy"></p>
<h3 id="javax-servlet-http-HttpServlet"><a href="#javax-servlet-http-HttpServlet" class="headerlink" title="javax.servlet.http.HttpServlet"></a>javax.servlet.http.HttpServlet</h3><p>JavaWeb: 报错信息The superclass “javax.servlet.http.HttpServlet” was not found on the Java Build Path:</p>
<p>​       报错原因：Javaweb工程类中没有添加Tomcat运行时相关类导致。</p>
<p>​        调试方法：</p>
<p>​           对项目添加Tomcat运行时</p>
<p>​              1、右击web工程–&gt;属性或Build Path–&gt;Java Build Path–&gt;Libraries–&gt;Add Libray–&gt;Server Runtime–&gt;Tomcat  Server</p>
<p>​              2、切换到Java Build Path界面中的Orader and Export，选择Tomcat。</p>
<p>   1.右键 —-》 Properties —-&gt; Java Build Path —-&gt; Libraries —-&gt; ClassPath —-&gt;Add Library —-&gt; Server Runtime —-&gt; Next —-&gt; 选择tomcat —-&gt; Finish</p>
<h1 id="四、JSP常用内置对象"><a href="#四、JSP常用内置对象" class="headerlink" title="四、JSP常用内置对象"></a>四、JSP常用内置对象</h1><h2 id="总览"><a href="#总览" class="headerlink" title="总览"></a>总览</h2><p>==九大内置内置对象：request、response、out、session、application、config、pageContext、page和exception==</p>
<table>
<thead>
<tr>
<th>对象名称</th>
<th>所属类型</th>
<th>作用域</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>request</td>
<td>javax.servlet.http.HttpServletRequest</td>
<td>request</td>
<td>提供对客户端HTTP请求数据的访问</td>
</tr>
<tr>
<td>response</td>
<td>javax.servlet.http.HttpServletResponse</td>
<td>page</td>
<td>响应信息，用来向客户端输出数据</td>
</tr>
<tr>
<td>session</td>
<td>javax.servlet.http.HttpSession</td>
<td>session</td>
<td>用来保存在服务器与一个客户端之间需要保存的数据，当客户端关闭网站的所有网页时，session变量会自动消失</td>
</tr>
<tr>
<td>out</td>
<td>javax.servlet.jsp.JspWriter</td>
<td>page</td>
<td>提供对输出流的访问</td>
</tr>
<tr>
<td>application</td>
<td>javax.servlet.ServletContext</td>
<td>application</td>
<td>应用程序上下文，允许JSP页面与包括在同一应用程序中的任何web组件共享信息</td>
</tr>
<tr>
<td>pagContext</td>
<td>javax.servlet.jsp.PageContext</td>
<td>page</td>
<td>JSP页面本身的上下文，它提供了一组方法来管理具有不同作用域的属性</td>
</tr>
<tr>
<td>page</td>
<td>javax.servlet.jsp.HttpJspPage</td>
<td>page</td>
<td>JSP页面对应的Servlet类实例</td>
</tr>
<tr>
<td>config</td>
<td>javax.servlet.ServletConfig</td>
<td>page</td>
<td>允许将初始化数据传递给一个JSP页面</td>
</tr>
<tr>
<td>exception</td>
<td>java.lang.Throwable</td>
<td>page</td>
<td>由指定的JSP“错误处理页面”访问的异常数据</td>
</tr>
</tbody></table>
<h2 id="4-1-out对象"><a href="#4-1-out对象" class="headerlink" title="4.1 out对象"></a>4.1 out对象</h2><h3 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h3><p>out对象调用print/newLine方法将数据输出到网页上，能控制管理输出缓冲区和输出流</p>
<h3 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h3><ol>
<li>print()/println()</li>
<li>newLine()</li>
<li>flush()  输出并清除缓冲区数据 </li>
<li>clearBuffer() 清除缓冲区</li>
<li>getBufferSize() 获取缓冲区大小</li>
<li>getRemaining() 获取剩余缓冲区空间</li>
<li>isAutoFlush() 是自动刷新缓冲区返回1</li>
<li>close() 关闭输出流</li>
</ol>
<h2 id="4-2-request对象"><a href="#4-2-request对象" class="headerlink" title="4.2 request对象"></a>4.2 request对象</h2><p><strong>存储请求消息</strong></p>
<h3 id="方法-1"><a href="#方法-1" class="headerlink" title="方法"></a>方法</h3><table>
<thead>
<tr>
<th>方法</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>setAttribute(String name,Object obj)</td>
<td>用于设置request中的属性及其属性值</td>
</tr>
<tr>
<td>getAttribute(String name)</td>
<td>用于返回name指定的属性值，若不存在指定的属性，就返回null</td>
</tr>
<tr>
<td>removeAttribute(string name)</td>
<td>用于删除请求中的一个属性</td>
</tr>
<tr>
<td>getParameter(string name)</td>
<td>用于获取客户端传送给服务器端的参数值</td>
</tr>
<tr>
<td>getParameterNames()</td>
<td>用于获取客户端传送给服务器端的所有参数名字</td>
</tr>
<tr>
<td>getParameterValues(String name)</td>
<td>用于获取指定参数的所有值</td>
</tr>
<tr>
<td>getCookies()</td>
<td>用于返回客户端的所有Cookie对象，结果是一个Cookie数组</td>
</tr>
<tr>
<td>getCharacterEncoding()</td>
<td>返回请求中的字符编码方式</td>
</tr>
<tr>
<td>getRequestURI()</td>
<td>用于获取发送请求字符串的客户端地址</td>
</tr>
<tr>
<td>getRemoteAddr()</td>
<td>用于获取客户端IP地址</td>
</tr>
<tr>
<td>getRemoteHost</td>
<td>用于获取客户端名字</td>
</tr>
<tr>
<td>getSession([Boolean create])</td>
<td>用于返回和请求相关的session。create参数是可选的，true时，若客户端没有创建session，就创建新的session</td>
</tr>
<tr>
<td>getServerName()</td>
<td>用于获取服务器的名字</td>
</tr>
<tr>
<td>getServletPath</td>
<td>用于获取客户端所请求的脚本文件的文件路径</td>
</tr>
<tr>
<td>getServerPort()</td>
<td>用于获取服务器的端口号</td>
</tr>
<tr>
<td>setCharacterEncoding(String charact)</td>
<td>指定请求编码，在getParameter()方法前使用，可以解决中文乱码问题</td>
</tr>
</tbody></table>
<ol>
<li><p><strong>String getParameter</strong>(String name) </p>
<p>用于获取传过来参数的值，不存在则为null</p>
<p><code>int age = Integer.parseInt(request.getParameter(&quot;username&quot;));</code></p>
</li>
<li><p><strong>getParameterNames</strong>（） </p>
<p>用于获取传过来的所有请求参数名称，得到Enumeration类的实例</p>
</li>
<li><p><strong>String[ ] getParameterValues</strong>(String name) </p>
<p>用来获取传过来的参数的<strong>所有值</strong>，返回字符串数组,<strong>checkboxs</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">String[] hobbies = request.getParameterValues(<span class="string">"hobbies"</span>);</span><br><span class="line"><span class="keyword">if</span>(hobbies != <span class="keyword">null</span>)&#123;</span><br><span class="line">    <span class="keyword">for</span>(String hobby : hobbys)&#123;</span><br><span class="line">        out.print(hobby+ <span class="string">"&amp;nbsp"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





</li>
</ol>
<ol start="4">
<li><p><strong>getAttribute</strong>(String name)</p>
<p>获取request对象的指定属性的值，不存在返回null</p>
</li>
<li><p><strong>setAttribute</strong>(String name, Object obj)</p>
<p>设置request对象中的属性及其属性值</p>
</li>
<li><p><strong>removeAttribute</strong>(String name)</p>
<p>删除request对象中的指定属性及其属性值</p>
</li>
</ol>
<ol start="7">
<li><p><strong>void setCharacterEncoding(“utf-8”)</strong></p>
<ul>
<li>设置请求编码，tomcat7以前默认不是utf-8</li>
</ul>
</li>
<li><p><strong>getRequestDispatcher(“b.jsp”).forward(request, response);</strong></p>
<ul>
<li><p>请求转发的方式跳转 a-&gt;b，页面不会变！</p>
</li>
<li><p>数据不会丢失</p>
</li>
</ul>
</li>
<li><p><strong>getServerContext();</strong></p>
<ul>
<li>获取项目的ServletContext对象</li>
</ul>
</li>
</ol>
<h3 id="Vector"><a href="#Vector" class="headerlink" title="Vector"></a>Vector</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义</span></span><br><span class="line">Vector errs = <span class="keyword">new</span> Vector();</span><br><span class="line"><span class="comment">//添加</span></span><br><span class="line">errs.addElement(<span class="keyword">new</span> String(<span class="string">"xxx"</span>));</span><br><span class="line"><span class="comment">//输出</span></span><br><span class="line">errsCount = errs.size();</span><br><span class="line">String str = <span class="keyword">new</span> String(<span class="string">""</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;errsCount; i++)&#123;</span><br><span class="line">    errOut += errs.elementAt(i).toString();</span><br><span class="line">    errOut += <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="其他方法"><a href="#其他方法" class="headerlink" title="其他方法"></a>其他方法</h3><p>getCharacterEncoding()</p>
<p>getContentLength()</p>
<p>getContentType()</p>
<p>getContextPath()</p>
<p>服务器地址</p>
<p>request.getLocalAddr()</p>
<p>服务器名称</p>
<p>request.getLocalName();</p>
<img src="C:\Users\MingYue\AppData\Roaming\Typora\typora-user-images\image-20200323181847734.png" alt="image-20200323181847734" style="zoom:80%;" / loading="lazy">

<img src="C:\Users\MingYue\AppData\Roaming\Typora\typora-user-images\image-20200323181905704.png" alt="image-20200323181905704" style="zoom:80%;" / loading="lazy">

<img src="C:\Users\MingYue\AppData\Roaming\Typora\typora-user-images\image-20200323181922669.png" alt="image-20200323181922669" style="zoom:80%;" / loading="lazy">

<h2 id="4-3-response对象"><a href="#4-3-response对象" class="headerlink" title="4.3 response对象"></a>4.3 response对象</h2><p><strong>响应对象</strong></p>
<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><ul>
<li>将服务器端相应数据发送到客户端</li>
<li>与request组成接受、发送数据的对象</li>
<li>重定向客户端请求</li>
<li>实现动态的基础</li>
</ul>
<h3 id="基础方法"><a href="#基础方法" class="headerlink" title="基础方法"></a>基础方法</h3><p><strong>反了？？？</strong></p>
<ul>
<li><p><strong>void addCookie(Cookie cookie)</strong></p>
</li>
<li><p><strong>void sendRedirect(String location)</strong></p>
<ul>
<li><strong>重定向、地址栏改变、第一次请求的数据数据丢失、请求2次</strong></li>
<li>服务器自己搞定</li>
<li><img src="C:%5CUsers%5CMingYue%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200330121806398.png" alt="image-20200330121806398" loading="lazy"></li>
<li><strong>request.getRequestDispatcher(“success.jsp”).forward(request,respond);</strong></li>
<li><strong>请求转发、地址栏不变、第一次请求的数据不变、请求一次</strong><ul>
<li>客户端发出第二次</li>
<li><img src="C:%5CUsers%5CMingYue%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200330121818514.png" alt="image-20200330121818514" loading="lazy"></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>void setContentType(String type)</strong></p>
<p>设置服务端响应的编码</p>
</li>
</ul>
<img src="C:\Users\MingYue\AppData\Roaming\Typora\typora-user-images\image-20200324001919238.png" alt="image-20200324001919238" style="zoom:80%;" / loading="lazy">



<img src="C:\Users\MingYue\AppData\Roaming\Typora\typora-user-images\image-20200324001935485.png" alt="image-20200324001935485" style="zoom:80%;" / loading="lazy">

<img src="C:\Users\MingYue\AppData\Roaming\Typora\typora-user-images\image-20200324001954095.png" alt="image-20200324001954095" style="zoom:80%;" / loading="lazy">

<p>setHeader(“refresh”, “1”)        设置指定名称和字符串的http文件头信息</p>
<p>setCharacterEncoding(“UTF-8”)    设置相应的字符编码方式</p>
<p>sendRedirect(“http://“)            重新定向客户端的请求</p>
<h2 id="4-4-session对象"><a href="#4-4-session对象" class="headerlink" title="4.4 session对象"></a>4.4 session对象</h2><h3 id="简介-1"><a href="#简介-1" class="headerlink" title="简介"></a>简介</h3><ul>
<li><p>值客户端与服务器端的一次会话，从客户端连接到服务器开始，直到客户端与服务器断开连接为止，</p>
</li>
<li><p>客户端第一次请求客户端时，服务端会产生一个session对象，保存该客户的信息</p>
<p>每个session对象都会有一个唯一的sessionID（用于区分其他session）</p>
<p>服务端产生一个cookie并发送个客户端，将cookie的name=JSESSIONID，value的服务器sessionID的值，</p>
<p>sessionID与JESSIONID一一对应</p>
</li>
<li><p>第一次访问时，服务器端产生一个sessionID并赋值给cookie的jessionID并发送给客户端。</p>
</li>
</ul>
<h3 id="与cookie"><a href="#与cookie" class="headerlink" title="与cookie"></a>与cookie</h3><ul>
<li><p><strong>session</strong>：在服务器端，会话：开始到结束,保存的是Object</p>
</li>
<li><p><strong>cookie</strong>  </p>
<ul>
<li><p>客户端，<strong>不是内置对象</strong>：由服务端产生，发送给客户端保存</p>
</li>
<li><p>本地缓存作用，提高访问服务端的效率，安全性较差，保存String</p>
</li>
<li><p>服务端会自动new一个cookie(name=JSESSIONID)</p>
</li>
<li><p>Cookie: key=value</p>
</li>
<li><p>javax.servlet.http.Cookie</p>
</li>
<li><p><strong>方法</strong></p>
<ul>
<li><strong>void setMaxage(init expiry)</strong> 最大有效期(秒)</li>
</ul>
</li>
<li><p>String getName() 获取name</p>
</li>
</ul>
</li>
<li><p>public Cookie(String name, String value)</p>
<ul>
<li><p><strong>增加cookie</strong></p>
</li>
<li><p>Cookie cookie = new Cookie(“name” ,”ming”);</p>
</li>
<li><p>response.addCookie(Cookie cookie);</p>
</li>
<li><p><strong>获取cookie(先跳转到客户端，转发、重定向)</strong></p>
<ul>
<li><p>Cookie[] cookies = request.getCookies();  只能获取全部</p>
</li>
<li><p>for(Cookie cookie : cookies){</p>
<p>​    out.print(cookie.getName()+ “ “+ cookie.getValue());</p>
<p>}</p>
</li>
<li><p>除了自己设置的，还有name: JSESSIONID的cookie</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="方法-2"><a href="#方法-2" class="headerlink" title="方法"></a>方法</h3><table>
<thead>
<tr>
<th>方法</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>Object getAttribute(String attriname)</td>
<td>用于获取与指定名字相联系的属性，如果属性不存在，将会返回null</td>
</tr>
<tr>
<td>void setAttribute(String name,Object value)</td>
<td>用于设定指定名字的属性值，并且把它存储在session对象中</td>
</tr>
<tr>
<td>void removeAttribute(String attriname)</td>
<td>用于删除指定的属性（包含属性名、属性值）</td>
</tr>
<tr>
<td>Enumeration getAttributeNames()</td>
<td>用于返回session对象中存储的每一个属性对象，结果集是一个Enumeration类的实例</td>
</tr>
<tr>
<td>long getCreationTime()</td>
<td>用于返回session对象被创建时间，单位为毫秒</td>
</tr>
<tr>
<td>long getLastAccessedTime()</td>
<td>用于返回session对象最后发送请求的时间，单位为毫秒</td>
</tr>
<tr>
<td>String getId()</td>
<td>用于返回session对象在服务器端的编号</td>
</tr>
<tr>
<td>long setMaxInactiveInterval()</td>
<td>用于返回session对象的生存时间，单位为秒</td>
</tr>
<tr>
<td>boolean isNew()</td>
<td>用于判断目前session是否为新的session，若是则返回true，否则返回false</td>
</tr>
<tr>
<td>void invalidate()</td>
<td>用于销毁session对象，使得与其绑定的对象都无效</td>
</tr>
</tbody></table>
<ol>
<li><p>void setAttribute(String name, Object value);</p>
<p>​    String.valueOf(number);</p>
<p>Integer.parseInt(obj.toString());</p>
</li>
<li><p>Object getAttribute(String name); 不存在返回null</p>
</li>
<li><p>removeAttribute(String name) ;删除指定属性</p>
</li>
<li><p>getAttributeName(); 返回session对象中所有属性的名称，结果是一个枚举类型的对象</p>
</li>
<li><p>getLastAccessedTime(); 返回当前session对象相关的客户端最后发送请求的时间</p>
</li>
<li><p>setMaxInactiveInterval(int interval); 设置有效时间</p>
</li>
<li><p>invalidate(); 使session对象失效，存放在session对象中的所有对象都不能再访问</p>
</li>
<li><p>isNew(); 判断是由为新session</p>
</li>
<li><p>getCreateTime(); 返回session对象呗创建时间，单位毫秒</p>
</li>
<li><p>getId(); 返回session对象的ID</p>
</li>
</ol>
<ol start="11">
<li><p>String getId(); 获取sessionID</p>
</li>
<li><p>boolean isNew(); 是否是第一次访问</p>
</li>
<li><p>void invalidate(); 使session失效</p>
</li>
<li><p>setAttribute(String, Object);</p>
</li>
<li><p>Object getAttribute();</p>
</li>
<li><p>void setMaxInactiveInterval(秒) 设置最大有效非活动时间(不操作时间)</p>
</li>
<li><p>int getMaxInactiveInterval(); </p>
</li>
<li><p>void removeAttribute();</p>
</li>
</ol>
<h2 id="4-5-pageContext对象"><a href="#4-5-pageContext对象" class="headerlink" title="4.5 pageContext对象"></a>4.5 pageContext对象</h2><h3 id="简介-2"><a href="#简介-2" class="headerlink" title="简介"></a>简介</h3><ul>
<li>对jsp页面所有对象及命名空间的访问</li>
<li>几种页面属性的访问</li>
<li>允许向其他应用组件转发request对象</li>
<li>创建和初始化都是由容器完成的</li>
</ul>
<h3 id="方法-3"><a href="#方法-3" class="headerlink" title="方法"></a>方法</h3><ol>
<li>setAttribute(String name, Object attribute); 页面范围</li>
<li>setAttribute(String name, Object obj, int scope); 指定范围</li>
<li>getAttribute(String name, int scope); 获取指定范围内指定属性的值</li>
<li>getAttribute(String name); 用于获取页面范围内指定属性的值</li>
<li>getOut() 返回当前的out对象</li>
<li>getPage() 返回当前的page对象</li>
<li>getRequest()</li>
<li>getResponse()</li>
<li>getSession()</li>
<li>getServletConfig()</li>
<li>getException()</li>
<li>getServletContext()</li>
<li>findAttribute(String name); 按照页面、请求、会话、以及应用程序范围的顺序实现对指定属性的搜索，返回其属性值或null</li>
<li>forward(java.lang.String relative UrlPath); 用于把页面重定向到另一个页面或servlet组件上</li>
<li>removeAttribute(); 删除所有对象范围或特定对象范围中的指定属性及其属性值</li>
<li>release（） 释放pageContext所占资源</li>
<li>include(String relativeUrlPath) 当前位置包含另一文件</li>
</ol>
<h2 id="4-6-exception对象"><a href="#4-6-exception对象" class="headerlink" title="4.6 exception对象"></a>4.6 exception对象</h2><h3 id="简介-3"><a href="#简介-3" class="headerlink" title="简介"></a>简介</h3><p>处理jsp文件在执行时的错误和异常</p>
<p>配合page指令一起使用，在page指令中errorPage属性指定某一个页面为出错误页面处理页面，把所有错误都在该错误页面处理，错误页面中的page指令isErrorPage属性为true</p>
<h3 id="方法-4"><a href="#方法-4" class="headerlink" title="方法"></a>方法</h3><ol>
<li>getMessage() 返回错误异常提示信息</li>
<li>getlocalizedMessage() 获取本地化错误信息</li>
<li>printStackTrace() 输出异常对象及其堆栈跟踪信息</li>
<li>toString() 返回关于异常的简短描述信息</li>
</ol>
<h2 id="4-7-application对象"><a href="#4-7-application对象" class="headerlink" title="4.7 application对象"></a>4.7 application对象</h2><h3 id="理解"><a href="#理解" class="headerlink" title="理解"></a>理解</h3><p>保存web应用应用程序中共有的数据，可存放全局变量，服务器启动后创建application对象，有效期至服务器关闭</p>
<h3 id="与session区别"><a href="#与session区别" class="headerlink" title="==与session区别=="></a>==与session区别==</h3><p>一个用户对应一个session，一个应用程序中的jsp文件共享一个application对象</p>
<ul>
<li><p>（1）      每个客户拥有自己的session对象，保存客户自有信息。如果有100个访问客户，就有100个session对象。所有客户共享同一个application对象，保存服务器运行期所有客户的共享信息，即使有100个访问客户也只有1个application对象。</p>
</li>
<li><p>（2）      session对象生命期从客户打开浏览器与服务器建立连接开始，到客户关闭浏览器为止，在客户的多个请求期间持续有效。application对象生命期从服务器启动开始，到服务器关闭为止。</p>
</li>
<li><p>（3）      可以使用session对象存储某个客户在一个会话期间的数据，例如记录某个客户的姓名、密码等。使用application对象存储服务器运行期所有客户共享的变量，例如记录所有客户的访问次数等。</p>
</li>
</ul>
<h3 id="方法-5"><a href="#方法-5" class="headerlink" title="方法"></a>方法</h3><p>（1）   Object getAttribute(String attriname)：获取指定属性的值。</p>
<p>（2）   void setAttribute(String attriname,Object attrivalue)：设置一个新属性并保存值。</p>
<p>（3）   void removeAttribute(String attriname)：从application对象中删除指定的属性。</p>
<p>（4）   Enumeration getAttributeNames()：获取application对象中所有属性的名称。</p>
<ol>
<li>getAttribute(String name); </li>
<li>getAttributeNames(); 返回Enumeration类型</li>
<li>getServerInfo(); 返回servlet容器名称和版本信息</li>
<li>getContext(String uripath); 返回指定的webApplication的application对象</li>
<li>getMimeType(String file); 返回指定文件的MIME类型</li>
<li>getResource(String path); 返回指定资源的URL路径</li>
<li>getServlet(String name); 返回application对象指定servlet</li>
<li>setAttribute(String name, Object obj); </li>
<li>removeAttribute(String name); </li>
<li>log(String msg ); 指定信息写入Servlet日志文件</li>
<li>application.getContextPath(); 获取相对路径</li>
<li>application.getRealPath();  获取绝对路径</li>
</ol>
<h3 id="request、session、application"><a href="#request、session、application" class="headerlink" title="request、session、application"></a>request、session、application</h3><p>application：全局作用域，生命周期从应用程序启动到结束</p>
<p>session：会话作用域，首次访问产生，关闭浏览器结束</p>
<p>request：请求作用于，客户端的一次请求，生命周期为一次请求或使用forward方式执行请求转发，也就是使用forward方式跳转多个jsp，这个页面可以使用，刷新后失效</p>
<h2 id="4-8-config对象"><a href="#4-8-config对象" class="headerlink" title="4.8 config对象"></a>4.8 config对象</h2><h2 id="4-9-page对象"><a href="#4-9-page对象" class="headerlink" title="4.9 page对象"></a>4.9 page对象</h2><p>相当于this</p>
<h2 id="4-10-四大范围对象"><a href="#4-10-四大范围对象" class="headerlink" title="4.10 四大范围对象"></a>4.10 四大范围对象</h2><p><strong>pageContext</strong>   page对象：当前页面有效</p>
<p><strong>request</strong>            请求对象:同一次请求，request.getRequsetDispatcher(“ “).forword(request, response)</p>
<p><strong>session</strong>            会话对象：同一次会话</p>
<p><strong>application</strong>     全局对象：全局,不同浏览器也有效，重启服务器后无效</p>
<p><strong>共有方法</strong>:</p>
<p>Object getAttribute(String name); </p>
<p>void setAttribute(String name, Object obj); 设置属性值(新增，修改);</p>
<p>void removeAttribute(String name); </p>
<h1 id="五、数据库"><a href="#五、数据库" class="headerlink" title="五、数据库"></a>五、数据库</h1><h2 id="JDBC"><a href="#JDBC" class="headerlink" title="JDBC"></a>JDBC</h2><p>JDBC（Java DataBase Connectivity）是一种访问数据库的技术标准，它是一种能通过<strong>Java语言访问数据库的应用程序接口（JDBC API）</strong>，由一组用Java语言编写的类和接口组成。对于访问一些使用结构化查询语言SQL的关系型数据库尤为有效。</p>
<h2 id="5-1-连接数据库"><a href="#5-1-连接数据库" class="headerlink" title="5.1 连接数据库"></a>5.1 连接数据库</h2><h3 id="编码"><a href="#编码" class="headerlink" title="编码"></a>编码</h3><p><strong>创建数据库</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> <span class="keyword">name</span> <span class="keyword">default</span> <span class="keyword">charset</span>=utf8;	</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">name</span>() <span class="keyword">default</span> <span class="keyword">charset</span>=utf8;</span><br></pre></td></tr></table></figure>

<p><strong>命令行</strong></p>
<p>set character_set_results=gbk;</p>
<h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><p><img src="C:%5CUsers%5CMingYue%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200331110543214.png" alt="image-20200331110543214" loading="lazy"></p>
<p><img src="C:%5CUsers%5CMingYue%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200413170337942.png" alt="image-20200413170337942" loading="lazy"></p>
<p>java.sql.DriverManager：用来加载和注册不同的JDBC驱动程序，为创建连接数据库提供支持。</p>
<h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><ul>
<li><p>将mysql-connector-java-5.11.31-bin.jar放入WEB-INF/lib</p>
</li>
<li><p>Build Path libraries add <strong>External</strong></p>
<p><img src="C:%5CUsers%5CMingYue%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200329155018835.png" alt="image-20200329155018835" loading="lazy"></p>
</li>
</ul>
<h3 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line"></span><br><span class="line">&lt;%<span class="meta">@page</span> <span class="keyword">import</span>=<span class="string">"java.sql.*"</span> %&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;%<span class="meta">@page</span> <span class="keyword">import</span>=<span class="string">"java.sql.DriverManager"</span> %&gt;</span><br><span class="line">&lt;%<span class="meta">@page</span> <span class="keyword">import</span>=<span class="string">"java.sql.ResultSet"</span> %&gt;</span><br><span class="line">&lt;%<span class="meta">@page</span> <span class="keyword">import</span>=<span class="string">"java.sql.Statement"</span> %&gt;</span><br><span class="line">&lt;%<span class="meta">@page</span> <span class="keyword">import</span>=<span class="string">"java.sql.Connection"</span> %&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">&lt;title&gt;数据库&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;table&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;td&gt;id&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;catname&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;num&lt;/td&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">		&lt;%</span><br><span class="line">			Connection con = <span class="keyword">null</span>;</span><br><span class="line">			Statement stmt = <span class="keyword">null</span>;</span><br><span class="line">			ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line">			Class.forName(<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br><span class="line">			String url=<span class="string">"jdbc:mysql://localhost:3306/blog?useUnicode=true&amp;characterEncoding=UTF-8"</span>;</span><br><span class="line">			con = DriverManager.getConnection(url, <span class="string">"root"</span>, <span class="string">"root"</span>);</span><br><span class="line">			stmt = con.createStatement();</span><br><span class="line">			String sql = <span class="string">"select * from cat"</span>;</span><br><span class="line">			rs = stmt.executeQuery(sql);</span><br><span class="line">			<span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line">		%&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;td&gt;&lt;%=rs.getString("cat_id") %&gt;&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;&lt;%=rs.getString("catname") %&gt;&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;&lt;%=rs.getString("num") %&gt;&lt;/td&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">		&lt;%&#125; </span><br><span class="line">			rs.close();</span><br><span class="line">			stmt.close();</span><br><span class="line">			con.close();</span><br><span class="line">		%&gt;</span><br><span class="line">	&lt;/table&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h2 id="5-2-SQL查询"><a href="#5-2-SQL查询" class="headerlink" title="5.2 SQL查询"></a>5.2 SQL查询</h2><h3 id="SQL查询语句"><a href="#SQL查询语句" class="headerlink" title="SQL查询语句"></a>SQL查询语句</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> [<span class="keyword">all</span>|<span class="keyword">distinct</span>] column1[,column2]</span><br><span class="line"><span class="keyword">from</span> table1,table2</span><br><span class="line">[<span class="keyword">where</span> <span class="string">"conditions"</span>]</span><br><span class="line">[<span class="keyword">group</span> <span class="keyword">by</span> <span class="string">"column-list"</span>]</span><br><span class="line">[<span class="keyword">having</span> <span class="string">"conditions"</span>]</span><br><span class="line">[<span class="keyword">order</span> <span class="keyword">by</span> <span class="string">"column-list"</span> [<span class="keyword">asc</span>|<span class="keyword">desc</span>]]</span><br></pre></td></tr></table></figure>

<h3 id="jsp执行"><a href="#jsp执行" class="headerlink" title="jsp执行"></a>jsp执行</h3><ul>
<li><p><strong>Statement</strong></p>
<ul>
<li>不带参数的SQL语句</li>
</ul>
</li>
<li><p><strong>PreparedStatement</strong></p>
<ul>
<li><p>带有IN类型参数的预编译过的SQL语句</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">PreparedStatement pstmt=con.prepareStatement(<span class="string">"insert into book values(?,?,?,?)"</span>);</span><br><span class="line"> pstmt.setString(<span class="number">1</span>,<span class="string">"05-01-18-1"</span>);</span><br><span class="line"> pstmt.setString(<span class="number">2</span>,<span class="string">"《SQL Server 7.0设计实务》"</span>);</span><br><span class="line"> pstmt.setString(<span class="number">3</span>,<span class="string">"人民邮电出版社"</span>);</span><br><span class="line"> pstmt.setDouble(<span class="number">4</span>,<span class="number">55.6</span>);</span><br><span class="line"> pstmt.execute();</span><br><span class="line"> pstmt.close();</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><strong>CallableStatement</strong></p>
<ul>
<li>执行数据库的存储过程</li>
</ul>
</li>
<li><p><strong>继承</strong></p>
</li>
</ul>
<h3 id="jsp发送执行查询语句"><a href="#jsp发送执行查询语句" class="headerlink" title="jsp发送执行查询语句"></a>jsp发送执行查询语句</h3><ol>
<li><p><strong>Statement</strong></p>
<ul>
<li><strong>Statement stmt = connection.createStatement(int type, int concurrency);</strong></li>
<li><strong>type</strong><ul>
<li>ResultSet.TYPE_INSENSITIVE右边上下滚动，数据库变化时，当前结果集不变</li>
<li>ResultSet.TYPE_SENSITIVE游标上下滚动，数据库变化时，当前的结果集随着变化</li>
</ul>
</li>
<li><strong>Concurrency</strong>参数<ul>
<li>ResultSet.CONCUR_READ_ONLY不能用结果集更新数据库中的表</li>
<li>ResultSet.CONCUR_READ_UPDATEABLE可用结果集更新数据库中的表</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Statement常用方法</strong></p>
<p>createStatement()</p>
<p><img src="C:%5CUsers%5CMingYue%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200329184559937.png" alt="image-20200329184559937" loading="lazy"></p>
</li>
<li><p><strong>PreparedStatement</strong></p>
<p>prepareStatement() <strong>无d</strong></p>
<ul>
<li><p>预编译处理，SQL语句中包含一个或多个IN参数，提高SQL语句的速度,提高性能，安全（避免SQL注入）</p>
</li>
<li><p>IN参数用？代替</p>
</li>
<li><p>pstmt = connection.prepareStatement(“SELECT * FROM student WHERE 年龄&gt;=? AND 性别=?”);</p>
<p>pstmt.setInt(1,22);pstmt.setString(“nan”);</p>
</li>
<li><p>pstmt = connection.prepareStatment(sql);</p>
<p>pstmt.setInt(1,333);pstmt.setString(2,”sdf”);</p>
</li>
<li><p>rs = pstmt.executeQuery();</p>
</li>
</ul>
</li>
</ol>
<ol start="4">
<li><p><strong>Callablestatement</strong></p>
<p>connection.prepareCall();</p>
<ul>
<li><p>存储过程（无返回值，用out参数替代）</p>
<p>{call 存储过程名（参数列表）}</p>
<p><img src="C:%5CUsers%5CMingYue%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200331162251435.png" alt="image-20200331162251435" loading="lazy"></p>
</li>
<li><p><img src="C:%5CUsers%5CMingYue%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200331162729778.png" alt="image-20200331162729778" loading="lazy"></p>
<p>返回值</p>
<p><img src="C:%5CUsers%5CMingYue%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200331163228158.png" alt="image-20200331163228158" loading="lazy"></p>
<p><img src="C:%5CUsers%5CMingYue%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200331163428646.png" alt="image-20200331163428646" loading="lazy"></p>
</li>
<li><p>存储函数（有返回值return）</p>
<p>{？ = call 存储函数名(参数列表)}</p>
<p>connection.prepareCall(“{call add TwoNum(?,?,?)}”);</p>
</li>
</ul>
<p>​    <img src="C:%5CUsers%5CMingYue%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200331163825392.png" alt="image-20200331163825392" loading="lazy"></p>
<p><img src="C:%5CUsers%5CMingYue%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200331163723221.png" alt="image-20200331163723221" loading="lazy"></p>
</li>
<li><p><strong>ResultSet</strong></p>
</li>
</ol>
<p>   getString(字段名|位置0)</p>
<p>   <img src="C:%5CUsers%5CMingYue%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200329185553465.png" alt="image-20200329185553465" loading="lazy"></p>
<h2 id="5-3-SQL更新"><a href="#5-3-SQL更新" class="headerlink" title="5.3 SQL更新"></a>5.3 SQL更新</h2><h3 id="插入"><a href="#插入" class="headerlink" title="插入"></a>插入</h3><p>insert into table_name(column_list)</p>
<p>values(   )</p>
<h3 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h3><p>update table_name</p>
<p>set column_name = expression</p>
<p>where </p>
<h3 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h3><p>delete from table_name</p>
<p>where</p>
<h2 id="5-4-获取的数据"><a href="#5-4-获取的数据" class="headerlink" title="5.4 获取的数据"></a>5.4 获取的数据</h2><p>ResultSet rs = statement.executeQuery(“select * from blog”);</p>
<p>1开始     </p>
<ul>
<li>rs.getInt() </li>
<li>rs.getString(1)</li>
<li>rs.getDate()</li>
</ul>
<h2 id="5-5总结"><a href="#5-5总结" class="headerlink" title="5.5总结"></a>5.5总结</h2><h3 id="总流程"><a href="#总流程" class="headerlink" title="总流程"></a>总流程</h3><ul>
<li>驱动Class.forName()</li>
<li>连接DriverManager.gerConnection()</li>
<li>操作数据库对象connection.createStatement()</li>
<li>数据executeQuery()</li>
</ul>
<p><img src="C:%5CUsers%5CMingYue%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200413172830974.png" alt="image-20200413172830974" loading="lazy"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.加载驱动程序</span></span><br><span class="line">Class.forName(<span class="string">"com.mysql.jdbc.Driver "</span>) </span><br><span class="line"><span class="comment">//2.连接数据库</span></span><br><span class="line">Connection con = DriverManager.getConnection</span><br><span class="line">(<span class="string">"jdbc:mysql://localhost:3306;DatabaseName=jspdb"</span>,<span class="string">"root"</span>,<span class="string">"123456"</span>)</span><br><span class="line"><span class="comment">//3.执行SQL(创建SQL语句，执行SQL语句)</span></span><br><span class="line">Statement stmt = con.createStatement() </span><br><span class="line"></span><br><span class="line">ResultSet rst = stmt.executeQuery(<span class="string">"select * from book;"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//返回修改多少条数据</span></span><br><span class="line">ResultSet rst = stmt.executeUpdate(<span class="string">"update table_name set age=1 where id=1 "</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//4.关闭连接</span></span><br><span class="line">rst.close();    stmt.close();    con.close()</span><br></pre></td></tr></table></figure>

<h3 id="解析"><a href="#解析" class="headerlink" title="解析"></a>解析</h3><ol>
<li><p><strong>JDBC</strong>:java DataBase Connectivity可以为多种关系型数据库提供统一的访问方式</p>
</li>
<li><p><strong>JDBC API</strong>：</p>
<ol>
<li>Connection：连接,由DriverManager产生</li>
<li>Statement（PreparedStatement）：增删改查，通过Connection产生</li>
<li>CallableStatement：调用数据库中的 存储过程/存储函数</li>
<li>Result：返回的结果集</li>
</ol>
</li>
<li><p><strong>jdbc访问数据库过程</strong></p>
<ol>
<li>导入驱动，加载驱动类</li>
<li>建立连接</li>
<li>发送SQL</li>
<li>处理结果集</li>
</ol>
</li>
<li><p><strong>数据库驱动</strong></p>
<p><img src="C:%5CUsers%5CMingYue%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200331114935247.png" alt="image-20200331114935247" loading="lazy"></p>
</li>
</ol>
<h3 id="未解之谜"><a href="#未解之谜" class="headerlink" title="未解之谜"></a>未解之谜</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.mysql.jdbc.Connection;</span><br><span class="line"><span class="keyword">import</span> com.mysql.jdbc.Statement;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DB</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException </span>&#123;</span><br><span class="line"></span><br><span class="line">		Connection con = <span class="keyword">null</span>;</span><br><span class="line">		Statement stmt = <span class="keyword">null</span>;</span><br><span class="line">		ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Class.forName(<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br><span class="line">			String url = <span class="string">"jdbc:mysql://localhost:3306/blog?userUnicode=true&amp;characterEncoding=UTF-8"</span>;</span><br><span class="line">			con = (Connection) DriverManager.getConnection(url, <span class="string">"root"</span>, <span class="string">"root"</span>);</span><br><span class="line">			stmt = (Statement) con.createStatement();</span><br><span class="line">			String sql = <span class="string">"select * from cat"</span>;</span><br><span class="line">			rs = stmt.executeQuery(sql);</span><br><span class="line">			<span class="comment">//int sum = stmt.executeUpdate(sql);</span></span><br><span class="line">			<span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line">				System.out.println(rs.getString(<span class="string">"cat_id"</span>));</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;<span class="keyword">catch</span>(ClassNotFoundException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">catch</span>(SQLException e )&#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				<span class="keyword">if</span>(rs!=<span class="keyword">null</span>) rs.close();</span><br><span class="line">				<span class="keyword">if</span>(stmt!=<span class="keyword">null</span>) stmt.close();</span><br><span class="line">				<span class="keyword">if</span>(con!=<span class="keyword">null</span>) con.close();</span><br><span class="line">			&#125;<span class="keyword">catch</span>(SQLException e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException </span>&#123;</span><br><span class="line">		update();</span><br><span class="line">		System.out.println(<span class="string">"???3??"</span>);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-6-异常"><a href="#5-6-异常" class="headerlink" title="5.6 异常"></a>5.6 异常</h2><p>ClassNotFoundException    :Class.forName()</p>
<p>SQLException</p>
<p>Exception</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(rs!==<span class="keyword">null</span>) rs.close();</span><br></pre></td></tr></table></figure>





<p>先打开后关闭</p>
<h1 id="六、JavaBean"><a href="#六、JavaBean" class="headerlink" title="六、JavaBean"></a>六、JavaBean</h1><p>模式一</p>
<h2 id="6-1-基础知识"><a href="#6-1-基础知识" class="headerlink" title="6.1 基础知识"></a>6.1 基础知识</h2><h3 id="概念-1"><a href="#概念-1" class="headerlink" title="概念"></a>概念</h3><ul>
<li>JavaBean是Java Web程序的重要组成部分，是一个可以重复使用的软件组件，是一个遵循特定写法的Java类，它封装了数据和业务逻辑，供JSP或Servlet调用，完成数据封装和数据处理功能。</li>
<li>作用：主要负责表示业务数据或者处理事务的JavaBean，如访问数据库，执行查询操作的JavaBeans， 它们在运行时不需要任何可视的界面。在JSP 程序中所用的JavaBean一般以不可见的组件为主 (即处理内部事务，不输出)。 </li>
</ul>
<p><strong>好处</strong></p>
<p>“一次性编写，任何地方执行，任何地方重用”</p>
<p><strong>自动生成修改获取方法</strong></p>
<p><img src="C:%5CUsers%5CMingYue%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200416105253870.png" alt="image-20200416105253870" loading="lazy"></p>
<h3 id="实质：java类"><a href="#实质：java类" class="headerlink" title="实质：java类"></a>实质：java类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> ch09</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Login</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String userName; <span class="comment">//户名</span></span><br><span class="line">    <span class="keyword">private</span> String password; <span class="comment">//密码</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Login</span><span class="params">()</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUserName</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> username</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserName</span><span class="params">( String userName)</span></span>&#123;</span><br><span class="line">   		<span class="keyword">this</span>.userName = userName;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getPassword</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> password;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPassword</span><span class="params">(String password)</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.password = password</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="规范"><a href="#规范" class="headerlink" title="规范"></a>规范</h3><p><strong>编写JavaBean</strong></p>
<p>设计JavaBean就是编写一个Java类，用Java语言编写JavaBean必须遵循以下规范：</p>
<ul>
<li><p>（1）   JavaBean是一个<strong>公共类</strong>。</p>
</li>
<li><p>（2）   JavaBean类具有一个公共的<strong>无参的构造方法</strong>。</p>
</li>
<li><p>（3）   JavaBean<strong>所有的属性定义为私有的</strong>。</p>
</li>
<li><p>（4）   在JavaBean中，需要<strong>对每个属性提供两个公共方法</strong>。假设属性名字是xxx，要提供的两个方法：</p>
<ul>
<li><p>setXxx()：用来设置属性xxx的值。</p>
</li>
<li><p><strong>getXxx()：用来获取属性xxx的值（若属性类型是boolean，则方法名为isXxx()）。</strong></p>
</li>
</ul>
</li>
</ul>
<p>（5）   定义JavaBean时，通常放在一个命名的包下。</p>
<h3 id="使用它"><a href="#使用它" class="headerlink" title="使用它"></a>使用它</h3><ul>
<li><p>（1）&lt;jsp:useBean&gt;：声明并创建JavaBean对象实例。</p>
<p>（2）&lt;jsp:setProperty&gt;：对JavaBean对象的指定属性设置值。</p>
<p>（3）&lt;jsp:getProperty&gt;：获取JavaBean对象指定属性的值，并显示在网页上。</p>
</li>
<li><p>声明JavaBean对象，需要使用&lt;jsp:useBean&gt;动作标签。语法格式为：</p>
<p>  &lt;jsp:useBean id=”对象名”class=”类名”scope=”有效范围”/&gt;</p>
<p>l id属性：指定所要创建的对象名称。</p>
<p>l class属性：用来指定JavaBean的类名，必须使用完全限定类名。</p>
<p>l scope属性：指定所要创建对象的作用范围，包括page、request、session、application这4个取值，默认值是page。</p>
</li>
<li><p>&lt;jsp:useBean id=”login” class=”ch09.Login”&gt;&lt;/jsp:useBean&gt;</p>
<ul>
<li><p>&lt;jsp:setProperty name=”login” property=”password” value=”1234”&gt;</p>
</li>
<li><p>&lt;jsp:getProperty name=”login” property=”password”&gt;</p>
</li>
</ul>
</li>
<li><p>&lt;% Login login = new Login(); %&gt;</p>
</li>
</ul>
<h3 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h3><p><img src="C:%5CUsers%5CMingYue%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200329203745466.png" alt="image-20200329203745466" loading="lazy"></p>
<h2 id="6-2-JavaBean连接数据库"><a href="#6-2-JavaBean连接数据库" class="headerlink" title="6.2 JavaBean连接数据库"></a>6.2 JavaBean连接数据库</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> sql;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DBConnection</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String driverName = <span class="string">"com.mysql.jdbc.Driver"</span>;</span><br><span class="line">    <span class="keyword">private</span> String url = <span class="string">"jdbc:mysql://localhost:3306/blog?useUnicode=true&amp;characterEncoding=UTF8"</span>;</span><br><span class="line">    <span class="keyword">private</span> String username = <span class="string">"root"</span>;</span><br><span class="line">    <span class="keyword">private</span> String password = <span class="string">"root"</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDriverName</span><span class="params">(String driverName)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.driverName = driverName;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDriverName</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.driverName;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUrl</span><span class="params">(String url)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.url = url;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUrl</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.url;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserName</span><span class="params">(String username)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.username = username;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUserName</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.username;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPassword</span><span class="params">(String password)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.password = password;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getPassword</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.password;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Connection <span class="title">getConnection</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            Class.forName(driverName);</span><br><span class="line">            <span class="keyword">return</span> DriverManager.getConnection(url, username, password);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="七、servlet"><a href="#七、servlet" class="headerlink" title="七、servlet"></a>七、servlet</h1><p>==右击项目名–JavaEEtools–第二个==</p>
<p>模式二</p>
<h2 id="7-1-servlet简介"><a href="#7-1-servlet简介" class="headerlink" title="7.1 servlet简介"></a>7.1 servlet简介</h2><p>class添加addlibary servlet runtime</p>
<h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><ul>
<li><p>Servlet作为J2EE的三大基础技术（JSP，Servlet和JavaBean）之一，是目前流行的开发企业Web应用的轻量级框架（Struts、Spring和Hibernate）的技术基础。Servlet是用Java语言编写的服务器端程序，它担当客户请求与服务器响应的中间层，属于JavaEE中间层技术，是由服务器端调用和执行的，可以处理客户端传来的HTTP请求，并返回一个响应。Servlet是按照Servlet自身规范编写的Java类，独立于平台，必须运行在支持Java技术的Web服务器中。Servlet容器是支持Servlet功能的Web服务器扩展，Servlet就是借助容器的请求∕响应机制与Web客户端进行交互。</p>
</li>
<li><p>所有的Servlet容器必须支持HTTP协议。当用户发送HTTP请求访问Web服务器时，由Servlet容器根据Servlet配置来决定调用某个具体的Servlet来处理请求。容器调用Servlet时，还将代表请求与响应的两个对象传递给Servlet，Servlet利用请求对象来定位远程用户，获取HTTP POST参数及相关数据，进行相应的逻辑流程处理，然后借助响应对象发送数据给用户。一旦Servlet完成请求处理，容器会刷新响应，把控制交还给Web服务器。</p>
</li>
<li><p>虽然用Servlet来生成Web页面十分复杂和繁琐，但Servlet的优势主要体现在它能利用Java语言的所有的优点，能访问Java平台提供的大量的API。故在Web应用中，Servlet主要用于流程的控制，页面生成则由其衍生技术JSP来完成。</p>
</li>
<li><p>Servlet由Servlet容器来负责Servlet实例的查找、创建以及整个生命周期的管理，Servlet整个生命周期分为四个阶段：加载、初始化、调用及销毁。这个生命周期是由javax.servlet.servlet.Servlet接口的init()、service()和destroy()方法所定义，Servlet具体<strong>生命周期</strong>如下。</p>
<ul>
<li><p>Servlet容器加载Servlet类并实例化一个Servlet实例对象</p>
</li>
<li><p>Servlet容器调用该实例对象的init（）方法进行初始化</p>
</li>
<li><p>如果Servlet容器收到对该Servlet的请求，则调用此实例对象的Servlet()处理请求并返回响应结果</p>
</li>
<li><p>Servlet容器卸载该Servlet前调用它的destroy()方法</p>
</li>
</ul>
</li>
</ul>
<h3 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h3><table>
<thead>
<tr>
<th>功能</th>
<th>类和接口</th>
</tr>
</thead>
<tbody><tr>
<td>Servlet实现</td>
<td>javax.servlet.Servlet，javax.servlet.SingleThreadModel  javax.servlet.GenericServlet，javax.servlet.http.Httpservlet</td>
</tr>
<tr>
<td>Servlet配置</td>
<td>javax.servlet.ServletConfig</td>
</tr>
<tr>
<td>Servlet异常</td>
<td>javax.servlet.ServletException，javax.servlet.UnavailableException</td>
</tr>
<tr>
<td>请求和响应</td>
<td>javax.servlet.ServletRequest，javax.servlet.ServletResponse  javax.servlet.ServletInputStream，javax.servlet.ServletOutputStream  javax.servlet.http.HttpServletRequest，javax.servlet.HttpServletResponse</td>
</tr>
<tr>
<td>会话跟踪</td>
<td>javax.servlet.http.HttpSession，javax.servlet.http.HttpSessionBindingListener  javax.servlet.http.HttpSessionBindingEvent</td>
</tr>
<tr>
<td>Servlet上下文</td>
<td>javax.servlet.ServletContext</td>
</tr>
<tr>
<td>Servlet协作</td>
<td>javax.servlet.RequestDispatcher</td>
</tr>
<tr>
<td>其他</td>
<td>javax.servlet.http.Cookie，javax.servlet.http.HttoUtils  ****</td>
</tr>
</tbody></table>
<p>其中，javax.servlet.Servlet接口是Java Servlet API的核心，它定义了与Servlet生命周期对应的方法，如 Servlet加载及初始化时调用的init()方法；用于处理用户请求的service()方法；Servlet销毁时调用的destroy()方法等。所有的Servlet类都必须通过直接或间接（继承实现了Servlet接口的类）的方式来实现Servlet接口。</p>
<h3 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h3><p>WEB-INF/web.xml</p>
  <servlet>

<pre><code>&lt;servlet-name&gt;ss&lt;/servlet-name&gt;</code></pre><p>​      <servlet-class>sql.DBconnection.java</servlet-class></p>
  </servlet>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;web-app id&#x3D;&quot;WebApp_ID&quot; version&#x3D;&quot;2.5&quot;&gt;</span><br><span class="line">	&lt;display-name&gt;helloServlet&lt;&#x2F;display-name&gt;</span><br><span class="line">	&lt;servlet&gt;</span><br><span class="line">		&lt;servlet-name&gt;helloServlet&lt;&#x2F;servlet-name&gt;</span><br><span class="line">		&lt;servlet-class&gt;common.HelloServlet&lt;&#x2F;servlet-class&gt;</span><br><span class="line">	&lt;&#x2F;servlet&gt;</span><br><span class="line">	&lt;servlet-mapping&gt;</span><br><span class="line">		&lt;servlet-name&gt;helloServlet&lt;&#x2F;servlet-name&gt;</span><br><span class="line">		&lt;url-pattern&gt;&#x2F;hello&lt;&#x2F;url-pattern&gt;</span><br><span class="line">	&lt;&#x2F;servlet-mapping&gt;</span><br><span class="line">&lt;&#x2F;web-app&gt;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span>…;</span><br><span class="line"><span class="keyword">import</span>…;</span><br><span class="line">    <span class="keyword">import</span> java.io.*;</span><br><span class="line">    <span class="keyword">import</span> javax.servlet.*;</span><br><span class="line">    <span class="keyword">import</span> javax.servlet.http.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Servlet</span> 类名称 <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request,HttpServletResponse response)</span><span class="keyword">throws</span> ServletException, IOException </span>&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request,HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request,HttpServletResponse response)</span></span>&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-2-生命周期"><a href="#7-2-生命周期" class="headerlink" title="7.2 生命周期"></a>7.2 生命周期</h2><h3 id="简介-4"><a href="#简介-4" class="headerlink" title="简介"></a>简介</h3><p>servlet是HttpServlet的子类，服务器完成该子类的创建和初始化，sservlet的生命周期定义了一个servlet如何被加载，初始化，以及它怎样接受请求，响应请求，提供服务。</p>
<h3 id="生命周期："><a href="#生命周期：" class="headerlink" title="生命周期："></a><strong>生命周期：</strong></h3><ul>
<li><p><strong>init（）</strong>：服务器初始化</p>
<ul>
<li>首次创建servlet才会调用init（）方法，不是每次请求都调用</li>
<li>首次调用对用servlet的URL或再次启动服务器时，就会创建servlet</li>
<li>当客户在请求servlet服务时，web服务器将启动一个新的线程，在这个线程中，调用service（）方法响应客户的请求</li>
</ul>
</li>
<li><p><strong>service()方法</strong>：初始化完毕，servlet对象调用该方法响应客户的请求</p>
<ul>
<li><p>每个请求，servlet都会调用该方法，并把servlet的请求对象和响应对象传递给service（）方法作为参数</p>
</li>
<li><pre><code class="java"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest request, ServletResponse response)</span></span>
<span class="function"><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    - request对象和response对象由servlet容器创建并传递给service（）方法，service（）方法会根据http请求的类型，调用相应的doGet（）或都Post（）等方法，service（）方法可以被调用多次</span><br><span class="line"></span><br><span class="line">- **destory()方法**：调用该方法销毁servlet对象</span><br><span class="line"></span><br><span class="line">  - servlet被卸载时，该方法自动调用，可以用来释放servlet占用的资源，如数据库连接，socket连接等。destory（）方法只会被调用一次</span><br><span class="line"></span><br><span class="line">  ### 技术特点</span><br><span class="line"></span><br><span class="line">  1. 有效性</span><br><span class="line">     1. 轻量java线程处理每一项请求，传统CGI中，n项请求同时指向一个CGI程序，该程序代码程序就会载入内存n次，但servlet时，可以存在n个线程，但只使用servlet类的一个副本</span><br><span class="line">     2. 当CGI程序完成请求工作时，就会终止程序，难以缓存计算结果、保持数据库连接开放，并允许依赖于永久数据的其他优化操作，但完成响应后，servlet仍然保留在内存中，因此可以直接在请求之间存储任意复杂的数据</span><br><span class="line">  2. 方便</span><br><span class="line">     1. servlet包含扩展基础结构，能自动对HTML表单数据进行分析和解码、读取和设置http头，处理cookie、跟踪会话已经其他高级功能</span><br><span class="line">  3. 强大</span><br><span class="line">     1. servlet可以直接与web服务器对话，而常规的CGI程序无法做到，web服务器的通信更易于将相对url转换为具体的路径名，多个servlet之间可以共享数据，这跟易于实现数据库连接共享和类似资源共享优化操作，servlet还可以保留不同请求的信息，简化了会话跟踪和换出你早期计算结果的一些技术</span><br><span class="line">  4. 可移植性</span><br><span class="line">     1. 集合每种主要的web服务器都可以通过插件或直接支持servlet</span><br><span class="line">  5. 安装性</span><br><span class="line">  6. 便宜</span><br><span class="line"></span><br><span class="line">## 7.3 servlet与jsp</span><br><span class="line"></span><br><span class="line">### 区别</span><br><span class="line"></span><br><span class="line">业务逻辑：servlet</span><br><span class="line"></span><br><span class="line">有servlet后有jsp</span><br><span class="line"></span><br><span class="line">- 编程方式不同</span><br><span class="line">  - servlet：java程序，jsp按照web规范编写的脚本语言</span><br><span class="line">- 编译方式不同</span><br><span class="line">  - servlet每次修改需要编译才能运行，jsp是被jspContainer编译为servlet文件</span><br><span class="line">- 运行速度不同</span><br><span class="line">  - jsp第一次访问需要编译成servlet，在次访问时，已经有对应的。class文件，不需要再次翻译和编译，在运行速度上servlet比jsp快</span><br><span class="line"></span><br><span class="line">## 7.4 部署和应用</span><br><span class="line"></span><br><span class="line">### 部署</span><br><span class="line"></span><br><span class="line">&#x2F;WEBJ-INF目录：</span><br><span class="line"></span><br><span class="line">1. servlet和web应用程序的初始化，通过配置文件，可以减少初始化值的硬编码</span><br><span class="line"></span><br><span class="line">## 7.5 重定向和转发</span><br><span class="line"></span><br><span class="line">### 介绍</span><br><span class="line"></span><br><span class="line">- 重定向功能</span><br><span class="line">  - 重定向的功能是将用户从当前页面或者Servlet定向到另外一个JSP页面或者Servlet；</span><br><span class="line">- 转发的功能</span><br><span class="line">  - 将用户对当前JSP页面或者Servlet对象的请求转发给另外一个JSP页面或者Servlet对象。</span><br><span class="line">- 在Servlet类中使用HttpServletResponse类 的 重 定 向 方 法sendRedirect()，以及RequestDispatcher类的转发方法forward()。</span><br><span class="line">- 两方法都能让浏览器获得另一个URL所指向的资源</span><br><span class="line"></span><br><span class="line">### 区别</span><br><span class="line"></span><br><span class="line">1. requestDispatcher的forward（）方法只能将请求转发给同一个web应用中的组件，而httpservletresponse的sendRedirect（）方法不仅可以重定向到当前应用程序中的其他资源，还可以重定向到同一个站点的其他应用程序中的资源，甚至是使用绝对URL重定向到其他站点的资源</span><br><span class="line">2. sendRedirect（）方法重定向访问过程结束后，地址栏URL改变，变成目标URL，而requestDispatcher的forward（）方法的请求转发过程结束后，地址栏的URL不变</span><br><span class="line">3. sendRedirect()方法对浏览器的请求直接作出相应，相应的结果是告诉浏览器去重新发出对另一个URL的访问请求；而requestDispatcher.forward()方法是在服务器内部件请求转发给另一个资源，浏览器只知道发出请求并得到相应结果，不知道在服务器内部发生了转发行为</span><br><span class="line">4. requestDispatcher的forward（）方法的调用者和被调用者之间共享相同的request对象和response对象，他们属于同一个访问请求和响应过程，而sendRedirect()方法调用者与被调用者使用各自的request对象和response对象，他们属于两个独立的访问请求和响应过程</span><br><span class="line">5. 无论是RequestDispatcher的forward()方法，还是HttpServletResponse的sendRedirect()方法，在调用它们之前，都不能有内容已经被实际输出到了客户端。如果缓冲区中已经有了一些内容，这些内容将被从缓冲区中清除。</span><br><span class="line"></span><br><span class="line">| **区别**         | **转发forward()**  | **重定向sendRedirect()** |</span><br><span class="line">| ---------------- | ------------------ | ------------------------ |</span><br><span class="line">| **根目录**       | 包含项目访问地址   | 没有项目访问地址         |</span><br><span class="line">| **地址栏**       | 不会发生变化       | 会发生变化               |</span><br><span class="line">| **哪里跳转**     | 服务器端进行的跳转 | 浏览器端进行的跳转       |</span><br><span class="line">| **请求域中数据** | 不会丢失           | 会丢失                   |</span><br><span class="line"></span><br><span class="line">## 7.6 sevlet过滤器</span><br><span class="line"></span><br><span class="line">### 简介</span><br><span class="line"></span><br><span class="line">Servlet过滤器（Filter）是在服务器上运行的，且位于请求与响应中间起过滤功能的程序。它是一个Java组件，是能改变HTTP请求、响应及头信息中内容的可重用代码。其工作原理大致是：在Servlet作为过滤器使用时，它可以对客户的请求进行处理，处理完毕之后它会交给下一个过滤器处理，这个客户的请求在过滤器链中逐个处理，直到请求发送到目标为止。</span><br><span class="line"></span><br><span class="line">因此，Filter主要功能在于它能通过某种拦截机制对请求进行预处理或对响应进行后处理，藉此修改或调整请求和响应的资源。Filter能作用于Web上的动态和静态资源，常用来完成诸如认证处理、日志、图像格式转换或加密等功能。开发者在以下情况下需要用到Filter：</span><br><span class="line"></span><br><span class="line">- 要在Servlet被调用之前访问资源；</span><br><span class="line"></span><br><span class="line">- 要在Servlet被调用之前检查request对象；</span><br><span class="line"></span><br><span class="line">- 要将request中的头信息和request数据封装成指定格式；</span><br><span class="line"></span><br><span class="line">-  要将response中的头信息和response数据封装成指定格式；</span><br><span class="line"></span><br><span class="line">-  要对servlet被调用之后进行拦截。</span><br><span class="line"></span><br><span class="line">### 应用场景</span><br><span class="line"></span><br><span class="line">自动登录、统一设置编码格式、访问权限控制、敏感字符过滤器</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### **过滤器的创建与配置**</span><br><span class="line"></span><br><span class="line">过滤器Filter的创建必须实现javax.servlet.Filter接口并提供一个无参构造函数。由javax.servlet.Filter接口定义了三个方法：</span><br><span class="line"></span><br><span class="line">- void init（FilterConfig config）：Filter初始化时执行的方法；</span><br><span class="line"></span><br><span class="line">-  void doFilter（ServletRequest request, ServletResponse response, FilterChain chain）：实现过滤功能，该方法就是对每个请求及响应增加额外的处理，并通过FilterChain对象的doFilter方法来调用下一个Filter，如是没有其它Filter，则调用最初的Servlet；</span><br><span class="line"></span><br><span class="line">- void destroy（）：Filter生命周期结束时，自动调用该方法。</span><br><span class="line"></span><br><span class="line">由于JSP并不能较好的支持中文，输入中文提交后，会输出乱码，下面就通过Filter来实现将所有请求的编码方式设为“UTF-8”以支持中文的正确显示，主要代码如下所示（EncodingFilter.java）：</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;java</span><br><span class="line">package common;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import javax.servlet.*;</span><br><span class="line">public class EncodingFilter implements Filter &#123;	</span><br><span class="line">    public EncodingFilter() &#123; </span><br><span class="line">    &#125;</span><br><span class="line">	public void init(FilterConfig fConfig) throws ServletException &#123;</span><br><span class="line">	&#125;</span><br><span class="line">	public void doFilter(ServletRequest request, ServletResponse response,</span><br><span class="line">			FilterChain chain) throws IOException, ServletException &#123;</span><br><span class="line">		&#x2F;&#x2F; 设置request的编码方式</span><br><span class="line">		request.setCharacterEncoding(&quot;UTF-8&quot;);</span><br><span class="line">		chain.doFilter(request, response);</span><br><span class="line">	&#125;</span><br><span class="line">	public void destroy() &#123;	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></span>
<span class="function"></span></code></pre>
</li>
</ul>
</li>
</ul>
<p>Filter与Servlet类一样，也是放置在Web应用的classes包中。Filter处理类创建完毕后，也必须在web.xml文件中配置Filter。关键代码如下：</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;filter&gt;</span><br><span class="line"></span><br><span class="line">       &lt;filter-name&gt;encoding&lt;&#x2F;filter-name&gt;</span><br><span class="line"></span><br><span class="line">       &lt;filter-class&gt;common.EncodingFilter&lt;&#x2F;filter-class&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;filter&gt;</span><br><span class="line"></span><br><span class="line">&lt;filter-mapping&gt;</span><br><span class="line"></span><br><span class="line">       &lt;filter-name&gt;encoding&lt;&#x2F;filter-name&gt;</span><br><span class="line"></span><br><span class="line">       &lt;url-pattern&gt;&#x2F;*&lt;&#x2F;url-pattern&gt;    &#x2F;&#x2F;  &#x2F;*拦截所有请求</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;filter-mapping&gt;</span><br></pre></td></tr></table></figure>



<p>Filter的配置主要包含两个部分：&lt;filter&gt;来配置Filter名称以及对应的Filter处理类；&lt;Filter-mapping&gt;来配置Filter与过滤的URL 模式。Servlet通常只配置一个URL ，而Filter可以同时拦截多个请求的URL，可以配置多个Filter拦截模式。示例中的encoding过滤器设置为对所有请求进行过滤。通过加载过滤器之后，前面示例中输入中文也能正常显示了。</p>
<h2 id="7-7-MVC模式"><a href="#7-7-MVC模式" class="headerlink" title="7.7 MVC模式"></a>7.7 MVC模式</h2><p>MVC（Model-View-Controller，模型—视图—控制器模式）是<a href="http://zh.wikipedia.org/zh-cn/软件工程" target="_blank" rel="noopener">软件工程</a>中的一种<a href="http://zh.wikipedia.org/zh-cn/软件架构" target="_blank" rel="noopener">软件架构</a>模式。MVC模式将整个应用系统分为三个基本部分：模型（Model）、视图（View）和控制器（Controller），其目的就是实现一种动态的程序设计，能使程序的修改和扩展简化，并且使程序模块的重复利用成为可能。</p>
<p>MVC模式各组成部分的主要功能如下：</p>
<ul>
<li><p><strong>模型（Model）</strong>：体现应用程序的功能，用于封装应用程序业务逻辑。模型有对数据直接访问的权力，如对数据库的访问。模型不依赖视图和控制器，也就是说，模型不关心它会被如何显示或是如何被操作，但是模型中数据的变化一般会通过一种机制被公布。模型必须提供一系列的功能性接口，以支持模型中功能的访问。</p>
</li>
<li><p><strong>视图（View）</strong>：主要用于描述模型。视图能够实现模型有目的的显示，允许一个模型对应多个视图。在视图中一般不包含应用程序上的业务逻辑，但模型中数据的变化必须在视图中得以体现。</p>
</li>
<li><p><strong>控制器（Controller）</strong>：用于控制应用程序的流程。控制器处理事件并做出响应，事件包括用户的行为和数据模型的改变。用户与视图交互时，可以通过控制器来更新模型状态，通知视图刷新显示。</p>
</li>
</ul>
<p>MVC模式并不能自动保证每一个结构设计都是正确的，如何在一个系统的设计中使用MVC架构模式与系统使用的技术密切相关。<strong>MVC模式的优点</strong>体现在以下几下方面：</p>
<ul>
<li><p>首先，在MVC模式中，系统的业务逻辑由模型来实现，视图负责数据的呈现，实现了业务逻辑和表示的分离，因此，多个视图能共享一个模型。同一个模型可以被不同的视图重用，大大提高了代码的可重用性。</p>
</li>
<li><p>其次，模型是自包含的，与控制器和视图保持相对独立，因此可以方便的更改应用程序的数据层和业务逻辑。而MVC的三个部分相互独立，改变其中一个并不会影响其他两个，所以依据这种设计思想能构造良好的松耦合的组件。</p>
</li>
<li><p>此外，控制器提高了应用程序的灵活性和可配置性。控制器可以用来连接不同的模型和视图去完成用户的需求。</p>
</li>
</ul>
<p>MVC的缺点是开发一个MVC架构的工程，将不得不考虑如何将MVC运用到应用程序中，这样会带来额外的工作，增加应用的复杂性。因此，MVC并不适合小型甚至中等规模的应用程序，但对于开发存在大量用户界面，并且逻辑复杂的大型应用程序，MVC将会使软件在健壮性、代码重用和结构方面上一个新的台阶。尽管在最初构建MVC框架时会花费一定的工作量，但从长远的角度来看，它会大大提高后期软件开发的效率。</p>
<h2 id="7-8-model2"><a href="#7-8-model2" class="headerlink" title="7.8 model2"></a>7.8 model2</h2><p>所谓模式2（Model 2）就是指基于MVC架构来构建Java Web应用的开发模式。在基于Model 2构建Java Web应用中，通常将Web应用的架构根据MVC模式划分为三个层次：</p>
<ol>
<li><p>视图层</p>
<p>视图层包括前端的HTML、XML、JSP及Applet等，主要充当用户的操作接口，负责数据的输入及结果的输出。该层的功能对应于MVC模式中的视图部分。</p>
</li>
<li><p>控制层</p>
<p>控制层的主要工作是控制整个应用的流程。控制层将视图层提交的数据，交付给业务逻辑层处理，并将结果返回至视图层。控制层的角色是介于视图层和业务逻辑层之中，该层的功能相当于MVC模式中的控制器部分。</p>
</li>
<li><p>业务逻辑层</p>
<p>业务逻辑层是应用的核心部分，它的主要功能包括：数据处理、数据的维护及业务逻辑的实现。该层的功能对应于MVC模式中的模型部分。</p>
</li>
</ol>
<p><img src="C:%5CUsers%5CMingYue%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200423105757667.png" alt="image-20200423105757667" loading="lazy"></p>
<p>在Model 2中，JSP负责数据显示逻辑，JavaBean负责业务逻辑，Servlet负责流程控制。并且Servlet不参加显示工作，只负责产生中间数据，并将这些数据以JavaBean的形式存储在session或其它对象中。这样的划分，使得Web应用的开发可以充分利用MVC模式的优点，使得视图层、控制层及业务逻辑层能并行开发，大在提高了Web应用开发的效率，也增加了Web应用的可重用性。</p>
<h1 id="八、java"><a href="#八、java" class="headerlink" title="八、java"></a>八、java</h1><h2 id="输入"><a href="#输入" class="headerlink" title="输入"></a>输入</h2><p>scanner sc = new scanner(System.in);</p>
<p>String name = sc.next();空格分隔</p>
<p> sc.netLine()</p>
<h1 id="九、考试内容"><a href="#九、考试内容" class="headerlink" title="九、考试内容"></a>九、考试内容</h1><h1 id="十、idea"><a href="#十、idea" class="headerlink" title="十、idea"></a>十、idea</h1><p><img src="C:%5CUsers%5CMingYue%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200426221626750.png" alt="image-20200426221626750" loading="lazy"></p>
<h2 id="快捷键"><a href="#快捷键" class="headerlink" title="快捷键"></a>快捷键</h2><p>sout 输出</p>
<p>psvm main() </p>
<p>调试</p>
<p>断点f7</p>
<p>web</p>
<p><img src="C:%5CUsers%5CMingYue%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200426225127978.png" alt="image-20200426225127978" loading="lazy"></p>
<p>lib</p>
<p><img src="http://yanxuan.nosdn.127.net/97318a981dcd9c8559017f2a13e79c19.png" alt="UTOOLS1587914028325.png" loading="lazy"></p>
<h1 id="十一、tomcat"><a href="#十一、tomcat" class="headerlink" title="十一、tomcat"></a>十一、tomcat</h1><p>server.xml 配置host，主机名</p>
<p><img src="C:%5CUsers%5CMingYue%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200427183548275.png" alt="image-20200427183548275" loading="lazy"></p>
<ol>
<li>访问</li>
<li>找本机host文件，</li>
<li>没有则到dos，变成ip</li>
</ol>
<h1 id="十二、bilibili"><a href="#十二、bilibili" class="headerlink" title="十二、bilibili"></a>十二、bilibili</h1><h2 id="12-1-准备工作"><a href="#12-1-准备工作" class="headerlink" title="12.1 准备工作"></a>12.1 准备工作</h2><h3 id="依赖"><a href="#依赖" class="headerlink" title="依赖"></a>依赖</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependencies&gt;</span><br><span class="line">  &lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;javax.servlet&lt;&#x2F;groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;javax.servlet-api&lt;&#x2F;artifactId&gt;</span><br><span class="line">    &lt;version&gt;4.0.1&lt;&#x2F;version&gt;</span><br><span class="line">  &lt;&#x2F;dependency&gt;</span><br><span class="line">  &lt;!-- https:&#x2F;&#x2F;mvnrepository.com&#x2F;artifact&#x2F;javax.servlet.jsp&#x2F;javax.servlet.jsp-api --&gt;</span><br><span class="line">  &lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;javax.servlet.jsp&lt;&#x2F;groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;javax.servlet.jsp-api&lt;&#x2F;artifactId&gt;</span><br><span class="line">    &lt;version&gt;2.3.3&lt;&#x2F;version&gt;</span><br><span class="line">    &lt;scope&gt;provided&lt;&#x2F;scope&gt;</span><br><span class="line">  &lt;&#x2F;dependency&gt;</span><br><span class="line">  &lt;!--mysql的驱动--&gt;</span><br><span class="line">  &lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;mysql&lt;&#x2F;groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;mysql-connector-java&lt;&#x2F;artifactId&gt;</span><br><span class="line">    &lt;version&gt;5.1.47&lt;&#x2F;version&gt;</span><br><span class="line">  &lt;&#x2F;dependency&gt;</span><br><span class="line">  &lt;!-- JSTL表达式的依赖 --&gt;</span><br><span class="line">  &lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;javax.servlet.jsp.jstl&lt;&#x2F;groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;jstl-api&lt;&#x2F;artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.2&lt;&#x2F;version&gt;</span><br><span class="line">  &lt;&#x2F;dependency&gt;</span><br><span class="line">  &lt;!-- standard标签库 --&gt;</span><br><span class="line">  &lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;taglibs&lt;&#x2F;groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;standard&lt;&#x2F;artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.1.2&lt;&#x2F;version&gt;</span><br><span class="line">  &lt;&#x2F;dependency&gt;</span><br><span class="line">  &lt;!--单元测试--&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;junit&lt;&#x2F;groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;junit&lt;&#x2F;artifactId&gt;</span><br><span class="line">        &lt;version&gt;4.12&lt;&#x2F;version&gt;</span><br><span class="line">    &lt;&#x2F;dependency&gt;</span><br><span class="line">    &lt;!--josn--&gt;</span><br><span class="line">    &lt;!-- https:&#x2F;&#x2F;mvnrepository.com&#x2F;artifact&#x2F;com.alibaba&#x2F;fastjson --&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;com.alibaba&lt;&#x2F;groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;fastjson&lt;&#x2F;artifactId&gt;</span><br><span class="line">      &lt;version&gt;1.2.68&lt;&#x2F;version&gt;</span><br><span class="line">    &lt;&#x2F;dependency&gt;</span><br><span class="line">&lt;&#x2F;dependencies&gt;</span><br></pre></td></tr></table></figure>

<h3 id="结构"><a href="#结构" class="headerlink" title="结构"></a>结构</h3><p><img src="http://yanxuan.nosdn.127.net/fe90ea29ac66ced6f2a29399ae50c115.png" alt="UTOOLS1588510474637.png" loading="lazy"></p>
<p><img src="C:%5CUsers%5CMingYue%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200430164803986.png" alt="image-20200430164803986" loading="lazy"></p>
<h3 id="数据库公共类"><a href="#数据库公共类" class="headerlink" title="数据库公共类"></a>数据库公共类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ming.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="comment">//操纵数据库基类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseDao</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String driver;;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String url;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String username;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//类加载的时候就初始化</span></span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        Properties properties = <span class="keyword">new</span> Properties();</span><br><span class="line">        InputStream is = BaseDao.class.getClassLoader().getResourceAsStream("db.properties");</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            properties.load(is);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(IOException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        driver = properties.getProperty(<span class="string">"driver"</span>);</span><br><span class="line">        url = properties.getProperty(<span class="string">"url"</span>);</span><br><span class="line">        username = properties.getProperty(<span class="string">"username"</span>);</span><br><span class="line">        password = properties.getProperty(<span class="string">"password"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取数据库连接</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> ClassNotFoundException </span>&#123;</span><br><span class="line">        Connection connection = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            Class.forName(driver);</span><br><span class="line">            connection = DriverManager.getConnection(url, username, password);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> connection;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//编写公共查询方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ResultSet <span class="title">executequery</span><span class="params">(Connection connection, String sql, Object[] params, ResultSet resultSet, PreparedStatement preparedStatement)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; params.length; i++)&#123;</span><br><span class="line">            preparedStatement.setObject(i+<span class="number">1</span>, params[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        resultSet = preparedStatement.executeQuery();</span><br><span class="line">        <span class="keyword">return</span> resultSet;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//编写公共修改方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">executeUpdate</span><span class="params">(Connection connection, String sql, Object[] params, PreparedStatement preparedStatement)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; params.length; i++)&#123;</span><br><span class="line">            preparedStatement.setObject(i+<span class="number">1</span>, params[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> updateRows = preparedStatement.executeUpdate();</span><br><span class="line">        <span class="keyword">return</span> updateRows;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//释放资源</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">closeResource</span><span class="params">(Connection connection, PreparedStatement preparedStatement, ResultSet resultSet)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        <span class="keyword">boolean</span> flag = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">if</span>(resultSet != <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                resultSet.close();</span><br><span class="line">                resultSet = <span class="keyword">null</span>;</span><br><span class="line">            &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">                flag = <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(preparedStatement != <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                preparedStatement.close();</span><br><span class="line">                preparedStatement = <span class="keyword">null</span>;</span><br><span class="line">            &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">                flag = <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(connection != <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                connection.close();</span><br><span class="line">                connection = <span class="keyword">null</span>;</span><br><span class="line">            &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">                flag = <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="过滤器"><a href="#过滤器" class="headerlink" title="过滤器"></a>过滤器</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;web-app xmlns&#x3D;&quot;http:&#x2F;&#x2F;xmlns.jcp.org&#x2F;xml&#x2F;ns&#x2F;javaee&quot;</span><br><span class="line">         xmlns:xsi&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2001&#x2F;XMLSchema-instance&quot;</span><br><span class="line">         xsi:schemaLocation&#x3D;&quot;http:&#x2F;&#x2F;xmlns.jcp.org&#x2F;xml&#x2F;ns&#x2F;javaee</span><br><span class="line">                      http:&#x2F;&#x2F;xmlns.jcp.org&#x2F;xml&#x2F;ns&#x2F;javaee&#x2F;web-app_4_0.xsd&quot;</span><br><span class="line">         version&#x3D;&quot;4.0&quot;</span><br><span class="line">         metadata-complete&#x3D;&quot;true&quot;&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;!--字符编码过滤器--&gt;</span><br><span class="line">    &lt;filter&gt;</span><br><span class="line">        &lt;filter-name&gt;CharacterEncodingFilter&lt;&#x2F;filter-name&gt;</span><br><span class="line">        &lt;filter-class&gt;com.ming.filter.CharacterEncodingFilter&lt;&#x2F;filter-class&gt;</span><br><span class="line">    &lt;&#x2F;filter&gt;</span><br><span class="line">    &lt;filter-mapping&gt;</span><br><span class="line">        &lt;filter-name&gt;CharacterEncodingFilter&lt;&#x2F;filter-name&gt;</span><br><span class="line">        &lt;url-pattern&gt;&#x2F;*&lt;&#x2F;url-pattern&gt;</span><br><span class="line">    &lt;&#x2F;filter-mapping&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;&#x2F;web-app&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">package com.ming.filter;</span><br><span class="line"></span><br><span class="line">import javax.servlet.*;</span><br><span class="line">import java.io.IOException;</span><br><span class="line"></span><br><span class="line">public class CharacterEncodingFilter implements Filter &#123;</span><br><span class="line">    public void init(FilterConfig filterConfig) throws ServletException &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException &#123;</span><br><span class="line">        servletRequest.setCharacterEncoding(&quot;UTF-8&quot;);</span><br><span class="line">        servletResponse.setCharacterEncoding(&quot;UTF-8&quot;);</span><br><span class="line">        filterChain.doFilter(servletRequest, servletResponse);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void destroy() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>导入静态资源到web</p>
<h3 id="jsp路径"><a href="#jsp路径" class="headerlink" title="jsp路径"></a>jsp路径</h3><p><code>${pageContext.request.contextPath}</code></p>
<h3 id="UUID"><a href="#UUID" class="headerlink" title="UUID"></a>UUID</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String str = UUID.randomUUID().toString();</span><br></pre></td></tr></table></figure>



<h3 id="maven"><a href="#maven" class="headerlink" title="maven"></a>maven</h3><p>maven由于他的约定大于配置，我们之后可以能遇到我们写的配置文件，无法被导出或者生效的问题，解决方案：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--在build中配置resources，来防止我们资源导出失败的问题--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>true<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>true<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="12-2-知识"><a href="#12-2-知识" class="headerlink" title="12.2 知识"></a>12.2 知识</h2><h3 id="读取配置文件"><a href="#读取配置文件" class="headerlink" title="读取配置文件"></a>读取配置文件</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">QQ</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Properties properties = <span class="keyword">new</span> Properties();</span><br><span class="line">    InputStream is = QQ.class.getClassLoader().getResourceAsStream("qq.properties");</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        properties.load(is);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    response_type = properties.getProperty(<span class="string">"response_type"</span>);</span><br><span class="line">    client_id = properties.getProperty(<span class="string">"client_id"</span>);</span><br><span class="line">    redirect_uri = properties.getProperty(<span class="string">"redirect_uri"</span>);</span><br><span class="line">    state = properties.getProperty(<span class="string">"state"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -e --nodeps</span><br></pre></td></tr></table></figure>



      
    </div>
    <footer class="article-footer">
      <a data-url="https://mingyuefusu.github.io/2020/05/14/jsp/" data-id="cka6j0rcm0002gwi50lk652mx" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-docker" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/05/14/docker/" class="article-date">
  <time datetime="2020-05-14T08:39:10.970Z" itemprop="datePublished">2020-05-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/05/14/docker/">docker</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="一、安装"><a href="#一、安装" class="headerlink" title="一、安装"></a>一、安装</h1><h2 id="1-1-要求"><a href="#1-1-要求" class="headerlink" title="1.1 要求"></a>1.1 要求</h2><p>centos7</p>
<p><code>uname -r</code></p>
<p><code>cat /etc/redhat-release</code></p>
<p><strong>c/c++</strong></p>
<p><code>yum -y install gcc</code></p>
<p><code>yum -y install gcc-c++</code></p>
<h2 id="1-2-下载"><a href="#1-2-下载" class="headerlink" title="1.2 下载"></a>1.2 下载</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">curl -sSL https:&#x2F;&#x2F;get.daocloud.io&#x2F;daotools&#x2F;set_mirror.sh | sh -s http:&#x2F;&#x2F;f1361db2.m.daocloud.io</span><br><span class="line"></span><br><span class="line">该脚本可以将 --registry-mirror 加入到你的 Docker 配置文件 &#x2F;etc&#x2F;docker&#x2F;daemon.json 中。适用于 Ubuntu14.04、Debian、CentOS6 、CentOS7、Fedora、Arch Linux、openSUSE Leap 42.1，其他版本可能有细微不同。更多详情请访问文档。</span><br><span class="line">&#x2F;etc&#x2F;docker&#x2F;daemon.json 逗号</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Windows</span><br><span class="line"></span><br><span class="line">Docker For Windows</span><br><span class="line"></span><br><span class="line">在桌面右下角状态栏中右键 docker 图标，修改在 Docker Daemon 标签页中的 json ，把下面的地址:</span><br><span class="line">http:&#x2F;&#x2F;f1361db2.m.daocloud.io</span><br><span class="line"></span><br><span class="line">加到&quot; registry-mirrors&quot;的数组里。点击 Apply 。</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">yum remove docker \</span><br><span class="line">                  docker-client \</span><br><span class="line">                  docker-client-latest \</span><br><span class="line">                  docker-common \</span><br><span class="line">                  docker-latest \</span><br><span class="line">                  docker-latest-logrotate \</span><br><span class="line">                  docker-logrotate \</span><br><span class="line">                  docker-engine</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum install -y yum-utils \</span><br><span class="line">  device-mapper-persistent-data \</span><br><span class="line">  lvm2</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">   sudo yum-config-manager \</span><br><span class="line">    --add-repo \</span><br><span class="line">    https:&#x2F;&#x2F;download.docker.com&#x2F;linux&#x2F;centos&#x2F;docker-ce.repo</span><br><span class="line">*&#x2F;</span><br><span class="line">    </span><br><span class="line">yum-config-manager --add-repo http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;docker-ce&#x2F;linux&#x2F;centos&#x2F;docker-ce.repo</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><figcaption><span>makecache fast ```更新yum软件包索引</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>yum install docker-ce docker-ce-cli containerd.io</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## 1.3 启动</span><br></pre></td></tr></table></figure>
<p>sudo systemctl start docker</p>
<p>docker run hello-world</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## 1.4 配置镜像</span><br></pre></td></tr></table></figure>
<p>mkdir -p /etc/docker</p>
<p>sudo tee /etc/docker/daemon.json &lt;&lt;-‘EOF’<br>{<br>  “registry-mirrors”: [“<a href="https://st53edx2.mirror.aliyuncs.com&quot;]">https://st53edx2.mirror.aliyuncs.com&quot;]</a><br>}<br>EOF</p>
<p>sudo systemctl daemon-reload</p>
<p>sudo systemctl restart docker</p>
<p>6中： service docker restart</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## 1.5 Centos6.8</span><br></pre></td></tr></table></figure>
<p>yum install -y epel-release<br>yum install -y docker-io<br>安装后的配置文件：/etc/sysconfig/docker<br>启动Docker后台服务：service docker start<br>docker version验证</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## 1.6 测试</span><br><span class="line"></span><br><span class="line">docker version</span><br><span class="line"></span><br><span class="line">docker run hello-world</span><br><span class="line"></span><br><span class="line">## 1.7 卸载</span><br></pre></td></tr></table></figure>
<p>systemctl stop docker </p>
<p>yum -y remove docker-ce</p>
<p>rm -rf /var/lib/docker</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 二、介绍</span><br><span class="line"></span><br><span class="line">## 2.1 简介</span><br><span class="line"></span><br><span class="line">基于Go语言实现的云开源项目，软件可以带环境安装，透过镜像(images)将作业系统核心除外，运作应用程式所需要的系统环境，由下而上打包，达到应用程式跨平台间的无缝接轨运作。</span><br><span class="line"></span><br><span class="line">### 理念</span><br><span class="line"></span><br><span class="line">Docker的主要目标是“Build，Ship and Run Any App,Anywhere”</span><br><span class="line"></span><br><span class="line">“一次封装，到处运行”，只需要一次配置好环境，换到别的机子上就可以一键部署好，大大简化了操作</span><br><span class="line"></span><br><span class="line">### 总结</span><br><span class="line"></span><br><span class="line">解决了运行环境和配置问题软件容器，方便做持续集成并有助于整体发布的容器虚拟化技术。</span><br><span class="line"></span><br><span class="line">## 2.2 作用</span><br><span class="line"></span><br><span class="line">### 介绍</span><br><span class="line"></span><br><span class="line">Linux 容器，Linux 容器不是模拟一个完整的操作系统，而是对进程进行隔离。有了容器，就可以将软件运行所需的所有资源打包到一个隔离的容器中。容器与虚拟机不同，不需要捆绑一整套操作系统，只需要软件工作所需的库资源和设置。系统因此而变得高效轻量并保证部署在任何环境中的软件都能始终如一地运行。</span><br><span class="line"></span><br><span class="line">### 比较</span><br><span class="line"></span><br><span class="line">比较了 Docker 和传统虚拟化方式的不同之处：</span><br><span class="line"></span><br><span class="line">- 传统虚拟机技术是虚拟出一套硬件后，在其上运行一个完整操作系统，在该系统上再运行所需应用进程；</span><br><span class="line">  而容器内的应用进程直接运行于宿主的内核，容器内没有自己的内核，而且也没有**进行硬件虚拟**。因此容器要比传统虚拟机更为轻便。</span><br><span class="line"></span><br><span class="line">* 每个容器之间互相隔离，每个容器有自己的文件系统 ，容器之间进程不会相互影响，能区分计算资源。</span><br><span class="line"></span><br><span class="line">## 2.3 一次构建、随处运行</span><br><span class="line"></span><br><span class="line">- 更快速的应用交付和部署</span><br><span class="line"></span><br><span class="line">- 更便捷的升级和扩缩容</span><br><span class="line"></span><br><span class="line">- 更简单的系统运维</span><br><span class="line"></span><br><span class="line">- 更高效的计算资源利用</span><br><span class="line">  - Docker是内核级虚拟化，其不像传统的虚拟化技术一样需要额外的Hypervisor支持，所以在一台物理机上可以运行很多个容器实例，可大大提升物理服务器的CPU和内存的利用率。</span><br><span class="line"></span><br><span class="line">## 2.4 官网</span><br><span class="line"></span><br><span class="line">docker官网：http:&#x2F;&#x2F;www.docker.com</span><br><span class="line"></span><br><span class="line">docker中文网站：https:&#x2F;&#x2F;www.docker-cn.com&#x2F;</span><br><span class="line"></span><br><span class="line">Docker Hub官网: https:&#x2F;&#x2F;hub.docker.com&#x2F;</span><br><span class="line"></span><br><span class="line">阿里云镜像：https:&#x2F;&#x2F;dev.aliyun.com&#x2F;search.html</span><br><span class="line"></span><br><span class="line"># 三、常用命令</span><br><span class="line"></span><br><span class="line">![image-20200329000057597](C:\Users\MingYue\AppData\Roaming\Typora\typora-user-images\image-20200329000057597.png)</span><br><span class="line"></span><br><span class="line">## 3.1 帮助命令</span><br><span class="line"></span><br><span class="line">### docker version</span><br><span class="line"></span><br><span class="line">### docker --help</span><br><span class="line"></span><br><span class="line">### docker info</span><br><span class="line"></span><br><span class="line">## 3.2 镜像命令</span><br><span class="line"></span><br><span class="line">### docker images</span><br><span class="line"></span><br><span class="line">列出本地主机上的镜像</span><br><span class="line"></span><br><span class="line">- **-a**    列出所有</span><br><span class="line">- **-q**    只显示镜像id</span><br><span class="line">- **--digests**    显示所有摘要信息</span><br><span class="line">- **--automated**    只列出automated build类型的镜像</span><br><span class="line"></span><br><span class="line">### docker search [ ] 镜像名</span><br><span class="line"></span><br><span class="line">网站：https:&#x2F;&#x2F;hub.docker.com</span><br><span class="line"></span><br><span class="line">- **--no-trunc** ：显示完整镜像描述</span><br><span class="line"></span><br><span class="line">- **-s n**  :列出收藏数不小于n的镜像</span><br><span class="line"></span><br><span class="line">- **--automated** 只列出automated build类型的镜像</span><br><span class="line"></span><br><span class="line">### docker pull 镜像名[:tag]</span><br><span class="line"></span><br><span class="line">没有tag则latest</span><br><span class="line"></span><br><span class="line">### docker rmi 镜像名字或ID </span><br><span class="line"></span><br><span class="line">- **-f** 镜像id1 镜像id2</span><br><span class="line">- **docker rmi -f $(docker images -qa)**</span><br><span class="line"></span><br><span class="line">## 3.3 容器命令1</span><br><span class="line"></span><br><span class="line">### docker run [ ] images [ 命令]</span><br><span class="line"></span><br><span class="line">- **--name&#x3D;&quot;newName&quot;**</span><br><span class="line"></span><br><span class="line">- **-d**   &#96;后台运行&#96;</span><br><span class="line"></span><br><span class="line">- **-i**   &#96;交互运行，与t同时用&#96;</span><br><span class="line"></span><br><span class="line">- **-t**   &#96;分配伪输入终端&#96;</span><br><span class="line"></span><br><span class="line">- **-P** &#96;随机端口映射&#96;</span><br><span class="line"></span><br><span class="line">- **-p** &#96;指定端口映射&#96;</span><br><span class="line"></span><br><span class="line">  ​	 ip:hostPort:containerPort</span><br><span class="line">  ​      ip::containerPort</span><br><span class="line">  ​      **hostPort:containerPort**	&#96;8080:8080&#96;</span><br><span class="line">  ​      containerPort</span><br><span class="line"></span><br><span class="line">- **docker run -it centos &#x2F;bin&#x2F;bash**</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- **-d**  	&#96;后台运行&#96;</span><br><span class="line">  </span><br><span class="line">- 如果没有进程交互将会删除</span><br><span class="line">  </span><br><span class="line">- **--privileged**</span><br><span class="line"></span><br><span class="line">  最高权限</span><br><span class="line"></span><br><span class="line">### docker ps [option]</span><br><span class="line"></span><br><span class="line">- **-a** 	&#96;列出所有正在运行和历史运行的的容器&#96;</span><br><span class="line">- **-l**      &#96;显示最近创建的容器&#96;</span><br><span class="line">- **-n**    &#96;显示最近x个容器&#96;</span><br><span class="line">- **-q**    &#96;只显示容器编号&#96;</span><br><span class="line">- **--no-trunc**  &#96;不截断输出&#96;</span><br><span class="line"></span><br><span class="line">### 退出容器</span><br><span class="line"></span><br><span class="line">- exit </span><br><span class="line">- ctrl + p + q</span><br><span class="line"></span><br><span class="line">### 不停运行</span><br><span class="line"></span><br><span class="line">&#96;docker run -d centos &#x2F;bin&#x2F;sh -c &quot;while true;do echo hello docker;sleep 2;done&quot;&#96;</span><br><span class="line"></span><br><span class="line">### docker restart ID或名字</span><br><span class="line"></span><br><span class="line">### docker stop ID或名字</span><br><span class="line"></span><br><span class="line">### docker kill ID或名字</span><br><span class="line"></span><br><span class="line">### docker rm 容器ID</span><br><span class="line"></span><br><span class="line">- docker rm -f $(docker ps -a -q)</span><br><span class="line">- docker ps -a -q | xargs docker rm</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## 3.4 容器命令2</span><br><span class="line"></span><br><span class="line">### docker logs</span><br><span class="line"></span><br><span class="line">- **-f** 跟随最新的日志打印</span><br><span class="line">- **-t** 加入时间戳</span><br><span class="line">- **--tail** **n** 显示最后n条</span><br><span class="line"></span><br><span class="line">### docker top 容器ID</span><br><span class="line"></span><br><span class="line">显示容器内运行的进程</span><br><span class="line"></span><br><span class="line">### docker inspect 容器ID</span><br><span class="line"></span><br><span class="line">显示容器内部细节</span><br><span class="line"></span><br><span class="line">### docker attach 容器ID·</span><br><span class="line"></span><br><span class="line">直接进入容器启动命令行</span><br><span class="line"></span><br><span class="line">### exec</span><br><span class="line"></span><br><span class="line">是在容器中打开新的终端，并且可以启动新的进程</span><br><span class="line"></span><br><span class="line">- **docker exec -it ID &#x2F;bin&#x2F;bash**</span><br><span class="line">- **docker exec ID ls -l**</span><br><span class="line"></span><br><span class="line">### docker save java &gt; &#x2F;root&#x2F;java.tar.gz</span><br><span class="line"></span><br><span class="line">### docker load &lt; &#x2F;home&#x2F;java.tar.gz</span><br><span class="line"></span><br><span class="line">### docker pause myjava</span><br><span class="line"></span><br><span class="line">### docker unpause myjava</span><br><span class="line"></span><br><span class="line">### docker cp 容器ID:容器内路径 目的主机路径</span><br><span class="line"></span><br><span class="line">拷贝</span><br><span class="line"></span><br><span class="line"># 四、Docker镜像</span><br><span class="line"></span><br><span class="line">## 4.1 简介</span><br><span class="line"></span><br><span class="line">### UnionFS（联合文件系统）</span><br><span class="line"></span><br><span class="line">- Union文件系统（UnionFS）是一种分层、轻量级并且高性能的文件系统，它支持对文件系统的修改作为一次提交来一层层的叠加，同时可以将不同目录挂载到同一个虚拟文件系统下(unite several directories into a single virtual filesystem)。Union 文件系统是 Docker 镜像的基础。镜像可以通过分层来进行继承，基于基础镜像（没有父镜像），可以制作各种具体的应用镜像。</span><br><span class="line"></span><br><span class="line">- 特性：一次同时加载多个文件系统，但从外面看起来，只能看到一个文件系统，联合加载会把各层文件系统叠加起来，这样最终的文件系统会包含所有底层的文件和目录</span><br><span class="line"></span><br><span class="line">### Docker镜像加载原理</span><br><span class="line"></span><br><span class="line">- docker的镜像实际上由一层一层的文件系统组成，这种层级的文件系统UnionFS。</span><br><span class="line">  **bootfs**(boot file system)主要包含bootloader和kernel, bootloader主要是引导加载kernel, Linux刚启动时会加载bootfs文件系统，在Docker镜像的最底层是bootfs。这一层与我们典型的Linux&#x2F;Unix系统是一样的，包含boot加载器和内核。当boot加载完成之后整个内核就都在内存中了，此时内存的使用权已由bootfs转交给内核，此时系统也会卸载bootfs。</span><br><span class="line"></span><br><span class="line">- rootfs (root file system) ，在bootfs之上。包含的就是典型 Linux 系统中的 &#x2F;dev, &#x2F;proc, &#x2F;bin, &#x2F;etc 等标准目录和文件。rootfs就是各种不同的操作系统发行版，比如Ubuntu，Centos等等。 </span><br><span class="line">- **对于一个精简的OS，rootfs可以很小，只需要包括最基本的命令、工具和程序库就可以了，因为底层直接用Host的kernel，自己只需要提供 rootfs 就行了**。由此可见对于不同的linux发行版, bootfs基本是一致的, rootfs会有差别, 因此不同的发行版可以公用bootfs。</span><br><span class="line"></span><br><span class="line">### 好处</span><br><span class="line"></span><br><span class="line">最大的一个好处就是 - 共享资源</span><br><span class="line"></span><br><span class="line">比如：有多个镜像都从相同的 base 镜像构建而来，那么宿主机只需在磁盘上保存一份base镜像，</span><br><span class="line">同时内存中也只需加载一份 base 镜像，就可以为所有容器服务了。而且镜像的每一层都可以被共享。</span><br><span class="line"></span><br><span class="line">### 特点</span><br><span class="line"></span><br><span class="line">Docker镜像都是只读的</span><br><span class="line">当容器启动时，一个新的可写层被加载到镜像的顶部。</span><br><span class="line">这一层通常被称作“容器层”，“容器层”之下的都叫“镜像层”。</span><br><span class="line"></span><br><span class="line">## 4.2 docker commit</span><br><span class="line"></span><br><span class="line">docker commit -m &quot;描述信息&quot; -a&#x3D;&quot;作者&quot; 容器ID 要创建的目标镜像名：[标签名]</span><br><span class="line"></span><br><span class="line"># 五、Docker 容器数据卷</span><br><span class="line"></span><br><span class="line">## 5.1 简介</span><br><span class="line"></span><br><span class="line">容器的持久化、容器间继承+共享数据</span><br><span class="line"></span><br><span class="line">## 5.2 数据卷</span><br><span class="line"></span><br><span class="line">### 直接添加</span><br><span class="line"></span><br><span class="line">- docker run -it -v &#x2F;宿主机绝对路径目录:&#x2F;容器内目录 镜像名</span><br><span class="line">  </span><br><span class="line">-  **只读**  docker run -it -v &#x2F;宿主机绝对路径目录:&#x2F;容器内目录:ro 镜像名 </span><br><span class="line">  </span><br><span class="line">- docker inspect 容器ID</span><br><span class="line"></span><br><span class="line">  查看是否挂载成功</span><br><span class="line"></span><br><span class="line">### DockerFile添加</span><br><span class="line"></span><br><span class="line">- **VOLUME**</span><br><span class="line">  </span><br><span class="line">- VOLUME[&quot;&#x2F;dataVolumeContainer&quot;,&quot;&#x2F;dataVolumeContainer2&quot;,&quot;&#x2F;dataVolumeContainer3&quot;]</span><br><span class="line">  </span><br><span class="line">- **file构建**</span><br></pre></td></tr></table></figure>
<h1 id="volume-testfile"><a href="#volume-testfile" class="headerlink" title="volume testfile"></a>volume testfile</h1><p>  FROM centos<br>  VOLUME [“/dataVolumeContainer1”,”/dataVolumeContainer2”]<br>  CMD echo “finished,——–success1”<br>  CMD /bin/bash</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- **bulid生成镜像**</span><br><span class="line"></span><br><span class="line">  - docker bulid -f &#96;&#x2F;myfile&#x2F;testfile&#96; -t &#96;mingming&#x2F;centos&#96;</span><br><span class="line"></span><br><span class="line">  - 使用-f 后的DockerFile构建镜像</span><br><span class="line">  - 没有-f 默认是该目录下的**Dockerfile**</span><br><span class="line"></span><br><span class="line">- **备注**</span><br><span class="line"></span><br><span class="line">  Docker挂载主机目录Docker访问出现cannot open directory .: Permission denied</span><br><span class="line">  解决办法：在挂载目录后多加一个--privileged&#x3D;true参数即可</span><br><span class="line"></span><br><span class="line">## 5.3 数据卷容器</span><br><span class="line"></span><br><span class="line">### 简介</span><br><span class="line"></span><br><span class="line">命名的容器挂载数据卷，其它容器通过挂载这个(父容器)实现数据共享，挂载数据卷的容器，称之为数据卷容器</span><br><span class="line"></span><br><span class="line">### volumes-from</span><br><span class="line"></span><br><span class="line">docker run -it --name test2 --volumes -from test1 centos</span><br><span class="line"></span><br><span class="line">共享test1的数据卷</span><br><span class="line"></span><br><span class="line">容器之间配置信息的传递，数据卷的生命周期一直持续到没有容器使用它为止</span><br><span class="line"></span><br><span class="line"># 六、DokerFile解析</span><br><span class="line"></span><br><span class="line">## 6.1 介绍</span><br><span class="line"></span><br><span class="line">Dockerfile是用来构建Docker镜像的构建文件，是由一系列命令和参数构成的脚本。</span><br><span class="line"></span><br><span class="line">### 步骤</span><br><span class="line"></span><br><span class="line">- 编写Dockerfile文件</span><br><span class="line">- docker build</span><br><span class="line">- docker run</span><br><span class="line"></span><br><span class="line">### 基础知识</span><br><span class="line"></span><br><span class="line">1. 每条保留字指令都必须为**大写字母**且后面要跟随至少一个参数</span><br><span class="line">2. 指令按照从上到下，顺序执行</span><br><span class="line">3. #表示注释</span><br><span class="line">4. 每条指令都会创建一个新的镜像层，并对镜像进行提交</span><br><span class="line"></span><br><span class="line">### 构建过程</span><br><span class="line"></span><br><span class="line">1. docker从基础镜像运行一个容器</span><br><span class="line">2. 执行一条指令并对容器作出修改</span><br><span class="line">3. 执行类似docker commit的操作提交一个新的镜像层</span><br><span class="line">4. docker再基于刚提交的镜像运行一个新容器</span><br><span class="line">5. 执行dockerfile中的下一条指令直到所有指令都执行完成</span><br><span class="line"></span><br><span class="line">*  Dockerfile是软件的设计图纸</span><br><span class="line">*  Docker镜像是软件的交付品</span><br><span class="line">*  Docker容器则可以认为是软件的运行态。</span><br><span class="line"></span><br><span class="line">## 6.2 保留字指令</span><br><span class="line"></span><br><span class="line">### **FROM**</span><br><span class="line"></span><br><span class="line">父类</span><br><span class="line"></span><br><span class="line">### MAINTAINER</span><br><span class="line"></span><br><span class="line">镜像维护者姓名和邮箱</span><br><span class="line"></span><br><span class="line">### RUN</span><br><span class="line"></span><br><span class="line">容器构建时需要运行的命令</span><br><span class="line"></span><br><span class="line">### EXPOSE</span><br><span class="line"></span><br><span class="line">容器对外暴露的端口</span><br><span class="line"></span><br><span class="line">### WORKDIR</span><br><span class="line"></span><br><span class="line">容器登录默认工作目录</span><br><span class="line"></span><br><span class="line">### ENV</span><br><span class="line"></span><br><span class="line">用来构建镜像过程中设置环境变量</span><br><span class="line"></span><br><span class="line">### ADD</span><br><span class="line"></span><br><span class="line">拷贝宿主机文件进入镜像，并自动处理URL和解压tar压缩包</span><br><span class="line"></span><br><span class="line">### COPY</span><br><span class="line"></span><br><span class="line">类似ADD，拷贝文件和目录到镜像中。</span><br><span class="line">将从构建上下文目录中 &lt;源路径&gt; 的文件&#x2F;目录复制到新的一层的镜像内的 &lt;目标路径&gt; 位置</span><br><span class="line"></span><br><span class="line">COPY src dest</span><br><span class="line"></span><br><span class="line">COPY [&quot;src&quot;, &quot;dest&quot;]</span><br><span class="line"></span><br><span class="line">### VOLUME</span><br><span class="line"></span><br><span class="line">容器数据卷，用于数据保存和持久化工作</span><br><span class="line"></span><br><span class="line">### CMD</span><br><span class="line"></span><br><span class="line">指定容器启动时运行的命令</span><br><span class="line"></span><br><span class="line">Dockerfile 中可以有多个 CMD 指令，但**只有最后一个生效**，CMD 会被 docker run 之后的参数替换</span><br><span class="line"></span><br><span class="line">### ENTRYPOINNT</span><br><span class="line"></span><br><span class="line">指定一个容器启动时要运行的命令</span><br><span class="line"></span><br><span class="line">ENTRYPOINT 的目的和 CMD 一样，都是在指定容器启动程序及参数</span><br><span class="line"></span><br><span class="line">### ONBUILD</span><br><span class="line"></span><br><span class="line">当构建一个被继承的Dockerfile时运行命令，父镜像在被子继承后父镜像的onbuild被触发</span><br><span class="line"></span><br><span class="line">## 6.3 案例</span><br><span class="line"></span><br><span class="line">### base镜像</span><br><span class="line"></span><br><span class="line">Docker Hub 中 99% 的镜像都是通过在 base 镜像中安装和配置需要的软件构建出来的</span><br><span class="line"></span><br><span class="line">### 自定义myCentos镜像</span><br><span class="line"></span><br><span class="line">1. **目的**</span><br><span class="line"></span><br><span class="line">   添加vim编辑器</span><br><span class="line"></span><br><span class="line">2. **编写Dockerfile**</span><br></pre></td></tr></table></figure>
<p>   FROM centos<br>   MAINTAINER mingming<a href="mailto:&#x32;&#56;&#x34;&#57;&#48;&#x38;&#54;&#x33;&#49;&#64;&#113;&#x71;&#x2e;&#99;&#111;&#x6d;">&#x32;&#56;&#x34;&#57;&#48;&#x38;&#54;&#x33;&#49;&#64;&#113;&#x71;&#x2e;&#99;&#111;&#x6d;</a></p>
<p>   ENV MYPATH /usr/local<br>   WORKDIR $MYPATH</p>
<p>   RUN yum -y install vim</p>
<p>   EXPOSE 80</p>
<p>   CMD echo $MYPATH<br>   CMD echo “success!!”<br>   CMD /bin/bash<br>   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">3. **bulid**</span><br><span class="line"></span><br><span class="line">   docker build -f Dockerfile -t 新镜像名:tag .</span><br><span class="line"></span><br><span class="line">   .....................................!!!!!!</span><br><span class="line"></span><br><span class="line">4. **run**</span><br><span class="line"></span><br><span class="line">   docker run -it 新镜像名:tag </span><br><span class="line"></span><br><span class="line">5. **history**</span><br><span class="line"></span><br><span class="line">   docker history 镜像名</span><br><span class="line"></span><br><span class="line">### CMD&#x2F;ENTERYPOINT </span><br><span class="line"></span><br><span class="line">- CMD</span><br><span class="line"></span><br><span class="line">  - 只会有一个CMD生效</span><br><span class="line"></span><br><span class="line">- ENTRERYPOINT</span><br><span class="line"></span><br><span class="line">  - 参数会传递给ENTRYPOINT，形成新的命令组合</span><br><span class="line"></span><br><span class="line">  -</span><br></pre></td></tr></table></figure><br>    FROM centos<br>    RUN yum install -y curl<br>    ENTRYPOINT [ “curl”, “-s”, “<a href="http://ip.cn&quot;" target="_blank" rel="noopener">http://ip.cn&quot;</a> ]<br>    <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    docker run this -i </span><br><span class="line"></span><br><span class="line">    X docker run this curl -s http:&#x2F;&#x2F;ip.cn -i  </span><br><span class="line"></span><br><span class="line">  - 本质： &lt;ENTRYPOINT&gt;  &quot;&lt;CMD&gt;&quot;</span><br><span class="line"></span><br><span class="line">### Tomcat9</span><br></pre></td></tr></table></figure><br>FROM         centos<br>MAINTAINER    zzyy<a href="mailto:&#122;&#x7a;&#121;&#121;&#98;&#115;&#64;&#49;&#50;&#54;&#46;&#99;&#111;&#109;">&#122;&#x7a;&#121;&#121;&#98;&#115;&#64;&#49;&#50;&#54;&#46;&#99;&#111;&#109;</a><br>#把宿主机当前上下文的c.txt拷贝到容器/usr/local/路径下<br>COPY c.txt /usr/local/cincontainer.txt<br>#把java与tomcat添加到容器中<br>ADD jdk-8u171-linux-x64.tar.gz /usr/local/<br>ADD apache-tomcat-9.0.8.tar.gz /usr/local/<br>#安装vim编辑器<br>RUN yum -y install vim<br>#设置工作访问时候的WORKDIR路径，登录落脚点<br>ENV MYPATH /usr/local<br>WORKDIR $MYPATH<br>#配置java与tomcat环境变量<br>ENV JAVA_HOME /usr/local/jdk1.8.0_171<br>ENV CLASSPATH $JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar<br>ENV CATALINA_HOME /usr/local/apache-tomcat-9.0.8<br>ENV CATALINA_BASE /usr/local/apache-tomcat-9.0.8<br>ENV PATH $PATH:$JAVA_HOME/bin:$CATALINA_HOME/lib:$CATALINA_HOME/bin<br>#容器运行时监听的端口<br>EXPOSE  8080<br>#启动时运行tomcat</p>
<h1 id="ENTRYPOINT-“-usr-local-apache-tomcat-9-0-8-bin-startup-sh”"><a href="#ENTRYPOINT-“-usr-local-apache-tomcat-9-0-8-bin-startup-sh”" class="headerlink" title="ENTRYPOINT [“/usr/local/apache-tomcat-9.0.8/bin/startup.sh” ]"></a>ENTRYPOINT [“/usr/local/apache-tomcat-9.0.8/bin/startup.sh” ]</h1><h1 id="CMD-“-usr-local-apache-tomcat-9-0-8-bin-catalina-sh”-”run”"><a href="#CMD-“-usr-local-apache-tomcat-9-0-8-bin-catalina-sh”-”run”" class="headerlink" title="CMD [“/usr/local/apache-tomcat-9.0.8/bin/catalina.sh”,”run”]"></a>CMD [“/usr/local/apache-tomcat-9.0.8/bin/catalina.sh”,”run”]</h1><p>CMD /usr/local/apache-tomcat-9.0.8/bin/startup.sh &amp;&amp; tail -F /usr/local/apache-tomcat-9.0.8/bin/logs/catalina.out</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># 七、常用安装</span><br><span class="line"></span><br><span class="line">## 7.1 步骤</span><br><span class="line"></span><br><span class="line">- search </span><br><span class="line">- pull</span><br><span class="line">- images</span><br><span class="line">- run</span><br><span class="line">- stop</span><br><span class="line">- rmi rm</span><br><span class="line"></span><br><span class="line">## 7.3 安装mysql</span><br></pre></td></tr></table></figure>
<p>docker run -p 12345:3306 –name mysql -v /zzyyuse/mysql/conf:/etc/mysql/conf.d -v /zzyyuse/mysql/logs:/logs -v /zzyyuse/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -d mysql:5.6</p>
<p>命令说明：<br>-p 12345:3306：将主机的12345端口映射到docker容器的3306端口。<br>–name mysql：运行服务名字<br>-v /zzyyuse/mysql/conf:/etc/mysql/conf.d ：将主机/zzyyuse/mysql录下的conf/my.cnf 挂载到容器的 /etc/mysql/conf.d<br>-v /zzyyuse/mysql/logs:/logs：将主机/zzyyuse/mysql目录下的 logs 目录挂载到容器的 /logs。<br>-v /zzyyuse/mysql/data:/var/lib/mysql ：将主机/zzyyuse/mysql目录下的data目录挂载到容器的 /var/lib/mysql<br>-e MYSQL_ROOT_PASSWORD=123456：初始化 root 用户的密码。<br>-d mysql:5.6 : 后台程序运行mysql5.6</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># 八、仓库</span><br><span class="line"></span><br><span class="line">## 8.1 上传、下载</span><br></pre></td></tr></table></figure>
<p>docker login –username=mingyuefusu registry.cn-hangzhou.aliyuncs.com</p>
<p>docker pull registry.cn-hangzhou.aliyuncs.com/mingyuefusu/test:[镜像版本号]</p>
<p>docker login –username=mingyuefusu registry.cn-hangzhou.aliyuncs.com</p>
<p>docker tag [ImageId] registry.cn-hangzhou.aliyuncs.com/mingyuefusu/test:[镜像版本号]</p>
<p>docker push registry.cn-hangzhou.aliyuncs.com/mingyuefusu/test:[镜像版本号]</p>
<p>```</p>
<p>docker run -it -p 80:80 -p 3306:3306 -v /root/app:/app 4f7d66d383bb bash</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://mingyuefusu.github.io/2020/05/14/docker/" data-id="cka6j0rc70000gwi5dmqqeh71" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-redis" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/05/14/redis/" class="article-date">
  <time datetime="2020-05-14T08:38:58.088Z" itemprop="datePublished">2020-05-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/05/14/redis/">redis</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="一、初见面"><a href="#一、初见面" class="headerlink" title="一、初见面"></a>一、初见面</h1><h2 id="1-1-安装"><a href="#1-1-安装" class="headerlink" title="1.1 安装"></a>1.1 安装</h2><h3 id="windows报错"><a href="#windows报错" class="headerlink" title="windows报错"></a>windows报错</h3><p>window下安装redis或启动报错：<br>creating server tcp listening socket 127.0.0.1:6379: bind No error</p>
<p>的解决方案如下按顺序输入如下命令就可以连接成功</p>
<ol>
<li>redis-cli.exe</li>
<li>shutdown</li>
<li>exit</li>
<li>redis-server.exe redis.windows.conf</li>
</ol>
<h3 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h3><p>解压 <code>tar -zxvf</code>，存放在opt目录 </p>
<p><strong>基本环境安装</strong></p>
<p><code>yum install gcc-c++</code> </p>
<p><code>gcc -v</code></p>
<p><code>make</code></p>
<p><code>make install</code></p>
<p><strong>默认路径</strong></p>
<p> <code>/usr/local/bin</code></p>
<p><img src="http://yanxuan.nosdn.127.net/5572fd903623e81b425e1b6eecc10f65.png" alt="UTOOLS1589000015651.png" loading="lazy"></p>
<p>conf修改为</p>
<p><code>daemonize yes</code> 后台启动</p>
<p><code>redis-server myConfig/redis.conf</code> 使用该配置文件启动</p>
<p><code>redis-cli -p 6379</code> 启动</p>
<p><code>ps -ef | grep redis</code>是否启动</p>
<p><code>shutdown</code>关闭</p>
<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><blockquote>
<p>redis-cli.exe -h 127.0.0.1 -p 6379</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">启动：</span><br><span class="line">redis-server.exe redis.windows.conf</span><br><span class="line">设置环境变量后启动：</span><br><span class="line">redis-server.exe</span><br><span class="line">本地启动：</span><br><span class="line">redis-cli</span><br><span class="line">使远程用：</span><br><span class="line">redis-cli.exe -h 127.0.0.1 -p 6379</span><br></pre></td></tr></table></figure>

<h2 id="1-2-使用"><a href="#1-2-使用" class="headerlink" title="1.2 使用"></a>1.2 使用</h2><h3 id="java"><a href="#java" class="headerlink" title="java"></a>java</h3><p><strong>连接</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.Jedis;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisJava</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//连接本地的 Redis 服务</span></span><br><span class="line">        Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">"localhost"</span>);</span><br><span class="line">        System.out.println(<span class="string">"连接成功"</span>);</span><br><span class="line">        <span class="comment">//查看服务是否运行</span></span><br><span class="line">        System.out.println(<span class="string">"服务正在运行: "</span>+jedis.ping());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>String</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis.clients.jedis.Jedis;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisStringJava</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//连接本地的 Redis 服务</span></span><br><span class="line">        Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">"localhost"</span>);</span><br><span class="line">        System.out.println(<span class="string">"连接成功"</span>);</span><br><span class="line">        <span class="comment">//设置 redis 字符串数据</span></span><br><span class="line">        jedis.set(<span class="string">"runoobkey"</span>, <span class="string">"www.runoob.com"</span>);</span><br><span class="line">        <span class="comment">// 获取存储的数据并输出</span></span><br><span class="line">        System.out.println(<span class="string">"redis 存储的字符串为: "</span>+ jedis.get(<span class="string">"runoobkey"</span>));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><strong>list</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.Jedis;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisListJava</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//连接本地的 Redis 服务</span></span><br><span class="line">        Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">"localhost"</span>);</span><br><span class="line">        System.out.println(<span class="string">"连接成功"</span>);</span><br><span class="line">        <span class="comment">//存储数据到列表中</span></span><br><span class="line">        jedis.lpush(<span class="string">"site-list"</span>, <span class="string">"Runoob"</span>);</span><br><span class="line">        jedis.lpush(<span class="string">"site-list"</span>, <span class="string">"Google"</span>);</span><br><span class="line">        jedis.lpush(<span class="string">"site-list"</span>, <span class="string">"Taobao"</span>);</span><br><span class="line">        <span class="comment">// 获取存储的数据并输出</span></span><br><span class="line">        List&lt;String&gt; list = jedis.lrange(<span class="string">"site-list"</span>, <span class="number">0</span> ,<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;list.size(); i++) &#123;</span><br><span class="line">            System.out.println(<span class="string">"列表项为: "</span>+list.get(i));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>set</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.Jedis;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisKeyJava</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//连接本地的 Redis 服务</span></span><br><span class="line">        Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">"localhost"</span>);</span><br><span class="line">        System.out.println(<span class="string">"连接成功"</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// 获取数据并输出</span></span><br><span class="line">        Set&lt;String&gt; keys = jedis.keys(<span class="string">"*"</span>); </span><br><span class="line">        Iterator&lt;String&gt; it=keys.iterator() ;   </span><br><span class="line">        <span class="keyword">while</span>(it.hasNext())&#123;   </span><br><span class="line">            String key = it.next();   </span><br><span class="line">            System.out.println(key);   </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="1-3-测试性能"><a href="#1-3-测试性能" class="headerlink" title="1.3 测试性能"></a>1.3 测试性能</h2><p><code>redis-benchmark</code></p>
<table>
<thead>
<tr>
<th>序号</th>
<th>选项</th>
<th>描述</th>
<th>默认值</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td><strong>-h</strong></td>
<td>指定服务器主机名</td>
<td>127.0.0.1</td>
</tr>
<tr>
<td>2</td>
<td><strong>-p</strong></td>
<td>指定服务器端口</td>
<td>6379</td>
</tr>
<tr>
<td>3</td>
<td><strong>-s</strong></td>
<td>指定服务器 socket</td>
<td></td>
</tr>
<tr>
<td>4</td>
<td><strong>-c</strong></td>
<td>指定并发连接数</td>
<td>50</td>
</tr>
<tr>
<td>5</td>
<td><strong>-n</strong></td>
<td>指定请求数</td>
<td>10000</td>
</tr>
<tr>
<td>6</td>
<td><strong>-d</strong></td>
<td>以字节的形式指定 SET/GET 值的数据大小</td>
<td>2</td>
</tr>
<tr>
<td>7</td>
<td><strong>-k</strong></td>
<td>1=keep alive 0=reconnect</td>
<td>1</td>
</tr>
<tr>
<td>8</td>
<td><strong>-r</strong></td>
<td>SET/GET/INCR 使用随机 key, SADD 使用随机值</td>
<td></td>
</tr>
<tr>
<td>9</td>
<td><strong>-P</strong></td>
<td>通过管道传输 <numreq> 请求</td>
<td>1</td>
</tr>
<tr>
<td>10</td>
<td><strong>-q</strong></td>
<td>强制退出 redis。仅显示 query/sec 值</td>
<td></td>
</tr>
<tr>
<td>11</td>
<td><strong>–csv</strong></td>
<td>以 CSV 格式输出</td>
<td></td>
</tr>
<tr>
<td>12</td>
<td><strong>-l</strong></td>
<td>生成循环，永久执行测试</td>
<td></td>
</tr>
<tr>
<td>13</td>
<td><strong>-t</strong></td>
<td>仅运行以逗号分隔的测试命令列表。</td>
<td></td>
</tr>
<tr>
<td>14</td>
<td><strong>-I</strong></td>
<td>Idle 模式。仅打开 N 个 idle 连接并等待。</td>
<td></td>
</tr>
</tbody></table>
<p><code>redis-benchmark -h localhost -p 6379 -c 100 -n 100000</code></p>
<p><img src="http://yanxuan.nosdn.127.net/40bd7116a64e79eb9f0197b348380075.png" alt="UTOOLS1589001505299.png" loading="lazy"></p>
<h2 id="1-4-简介"><a href="#1-4-简介" class="headerlink" title="1.4 简介"></a>1.4 简介</h2><p>redis是单线程的</p>
<p>基于内存操作，瓶颈是机器的内存和网络带宽</p>
<p>c语言编写，100000+QPS，不比memecache</p>
<h3 id="为何那么快？"><a href="#为何那么快？" class="headerlink" title="为何那么快？"></a>为何那么快？</h3><ol>
<li>误区：高性能服务器就是高线程的</li>
<li>误区：多线程一定比单线程效率高</li>
</ol>
<p><strong>核心：</strong></p>
<p>redis将所有数据都放在内存中，单线程不需要上下文切换，</p>
<h1 id="二、语法"><a href="#二、语法" class="headerlink" title="二、语法"></a>二、语法</h1><h2 id="2-1-命令"><a href="#2-1-命令" class="headerlink" title="2.1 命令"></a>2.1 命令</h2><h3 id="连接"><a href="#连接" class="headerlink" title="连接"></a>连接</h3><p><code>redis-cli</code> 连接本地</p>
<p><code>ping</code> 检测是否启动</p>
<p><code>redis-cli -h host -p port -a password</code> 连接远程</p>
<p><code>dbsize</code>查看db大小</p>
<p><code>select n</code> 切换数据库</p>
<p><code>keys *</code> 查看所有的key</p>
<p><code>flushdb</code> 清空当前数据库</p>
<p><code>flushall</code> 清空所有数据库</p>
<h2 id="2-2-键redis-key"><a href="#2-2-键redis-key" class="headerlink" title="2.2 键redis-key"></a>2.2 键redis-key</h2><p>格式 <code>command key_name</code></p>
<p><strong>设置</strong> <code>set name ming</code> </p>
<p><strong>删除</strong> <code>del name</code></p>
<table>
<thead>
<tr>
<th>命令</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><code>del key</code></td>
<td>删除  key</td>
</tr>
<tr>
<td><code>dump key</code></td>
<td>序列化给定 key ，并返回被序列化的值</td>
</tr>
<tr>
<td><code>exists key</code></td>
<td>检查给定 key 是否存在</td>
</tr>
<tr>
<td><code>expire key seconds</code></td>
<td>为给定 key 设置过期时间，以秒计</td>
</tr>
<tr>
<td><code>expireat key timestamp</code></td>
<td>设置 key 过期时间的时间戳(unix timestamp) 以毫秒计</td>
</tr>
<tr>
<td><code>keys pattern</code></td>
<td>查找所有符合给定模式( pattern)的 key</td>
</tr>
<tr>
<td><code>move key db</code></td>
<td>将当前数据库的 key 移动到给定的数据库 db 当中。</td>
</tr>
<tr>
<td><code>persist key</code></td>
<td>移除key的过期时间，key永久保持</td>
</tr>
<tr>
<td><code>pttl key</code></td>
<td>以毫秒为单位返回 key 的剩余的过期时间</td>
</tr>
<tr>
<td><code>ttl key</code></td>
<td>以秒为单位，返回给定 key 的剩余生存时间(TTL, time to live)</td>
</tr>
<tr>
<td><code>randomkey</code></td>
<td>从当前数据库中随机返回一个 key</td>
</tr>
<tr>
<td><code>rename key newkey</code></td>
<td>修改 key 的名称</td>
</tr>
<tr>
<td><code>type key</code></td>
<td>返回 key 所储存的值的类型</td>
</tr>
</tbody></table>
<h2 id="2-3-字符串String"><a href="#2-3-字符串String" class="headerlink" title="2.3 字符串String"></a>2.3 字符串String</h2><p>除了字符串，还能是数字</p>
<ul>
<li><p>计数器</p>
</li>
<li><p>阅读量</p>
<p>粉丝数</p>
</li>
<li><p>对象缓存存储</p>
</li>
</ul>
<p><code>set name ming</code></p>
<p><code>get name</code></p>
<table>
<thead>
<tr>
<th>命令</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>set key value</td>
<td>设置指定 key 的值</td>
</tr>
<tr>
<td>get key</td>
<td>获取指定 key 的值。</td>
</tr>
<tr>
<td>getrange key start end</td>
<td>返回 key 中字符串值的子字符</td>
</tr>
<tr>
<td>getset key value</td>
<td>将给定 key 的值设为 value ，并返回 key 的旧值(old value)。</td>
</tr>
<tr>
<td>getbit key offset</td>
<td>对 key 所储存的字符串值，获取指定偏移量上的位(bit)。</td>
</tr>
<tr>
<td>mget key1 [key2…]</td>
<td>获取所有(一个或多个)给定 key 的值。</td>
</tr>
<tr>
<td>setbit key offset value</td>
<td>对 key 所储存的字符串值，设置或清除指定偏移量上的位(bit)。</td>
</tr>
<tr>
<td>setex key seconds value</td>
<td>将值 value 关联到 key ，并将 key 的过期时间设为 seconds (以秒为单位)。</td>
</tr>
<tr>
<td><code>setnx key value</code></td>
<td>只有在 key 不存在时设置 key 的值。</td>
</tr>
<tr>
<td>setrange key offset value</td>
<td>用 value 参数覆写给定 key 所储存的字符串值，从偏移量 offset 开始。</td>
</tr>
<tr>
<td>strlen key</td>
<td>返回 key 所储存的字符串值的长度。</td>
</tr>
<tr>
<td>mset key value [key value]</td>
<td>同时设置一个或多个 key-value 对。</td>
</tr>
<tr>
<td>msetnx key value [key value]</td>
<td>同时设置一个或多个 key-value 对，当且仅当所有给定 key 都不存在,同时</td>
</tr>
<tr>
<td>psetex key millseconds value</td>
<td>以毫秒为单位设置 key 的生存时间</td>
</tr>
<tr>
<td>incr key</td>
<td>将 key 中储存的数字值增一。</td>
</tr>
<tr>
<td>incrby key increment</td>
<td>将 key 所储存的值加上给定的增量值（increment） 。</td>
</tr>
<tr>
<td>incrbyfloat key increment</td>
<td>将 key 所储存的值加上给定的浮点增量值（increment） 。</td>
</tr>
<tr>
<td>decr key</td>
<td>将 key 中储存的数字值减一。</td>
</tr>
<tr>
<td>decrby key decrement</td>
<td>key 所储存的值减去给定的减量值（decrement） 。</td>
</tr>
<tr>
<td>append key value</td>
<td>如果 key 已经存在并且是一个字符串， APPEND 命令将指定的 value 追加到该 key 原来值（value）的末尾。</td>
</tr>
</tbody></table>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mset user:1:name mingyue user:1:age 20</span><br><span class="line">#对象</span><br><span class="line">set user:1 &#123;name:ming,age:3&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-4-列表List"><a href="#2-4-列表List" class="headerlink" title="2.4 列表List"></a>2.4 列表List</h2><p>栈、队列、阻塞队列</p>
<p>list命令l开头</p>
<h3 id="Redis-列表命令"><a href="#Redis-列表命令" class="headerlink" title="Redis 列表命令"></a>Redis 列表命令</h3><p>下表列出了列表相关的基本命令：</p>
<table>
<thead>
<tr>
<th>命令</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td>lpush  key value</td>
<td>插入列表头部（左）</td>
</tr>
<tr>
<td>rpush key value</td>
<td>插入尾部（右）</td>
</tr>
<tr>
<td>lrange key begin end</td>
<td>lrange key 0 -1</td>
</tr>
<tr>
<td>lpop</td>
<td>返回并移除左边第一个</td>
</tr>
<tr>
<td>rpop</td>
<td></td>
</tr>
<tr>
<td>lindex key offset</td>
<td>获取key中n的值</td>
</tr>
<tr>
<td>llen key</td>
<td>获取长度</td>
</tr>
<tr>
<td>lrem key number value</td>
<td>删除number个 key中的value</td>
</tr>
<tr>
<td>ltrim begin end</td>
<td>通过下标截取指定位置的list，会修改</td>
</tr>
<tr>
<td>rpoplpush key newkey</td>
<td>移除列表中最后一个元素移动到新list</td>
</tr>
<tr>
<td>lset key index value</td>
<td>在index设置为value，不存在列表就报错</td>
</tr>
<tr>
<td>linsert key after|before value [value]</td>
<td></td>
</tr>
</tbody></table>
<h2 id="2-5-集合set"><a href="#2-5-集合set" class="headerlink" title="2.5 集合set"></a>2.5 集合set</h2><p>无序、不能重复</p>
<table>
<thead>
<tr>
<th>命令</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td>sadd key value</td>
<td></td>
</tr>
<tr>
<td>smemebers key</td>
<td>获取集合元素</td>
</tr>
<tr>
<td>sismember key value</td>
<td>返回1,0</td>
</tr>
<tr>
<td>scard key</td>
<td>获取set集合中元素个数</td>
</tr>
<tr>
<td>srem key value</td>
<td>移除value</td>
</tr>
<tr>
<td>srandmember key</td>
<td>随机获取一个</td>
</tr>
<tr>
<td>spop key</td>
<td>随机移除并返回一个</td>
</tr>
<tr>
<td>smove key newkey value</td>
<td></td>
</tr>
<tr>
<td>sdiff key1 key2</td>
<td>a、b差集</td>
</tr>
<tr>
<td>sinter key1 key2</td>
<td>a、b交集 (共同好友)</td>
</tr>
<tr>
<td>sunion key1 key2</td>
<td>a、b并集</td>
</tr>
</tbody></table>
<h2 id="2-6-哈希hash"><a href="#2-6-哈希hash" class="headerlink" title="2.6 哈希hash"></a>2.6 哈希hash</h2><p>和string没有很大区别，map集合</p>
<p>适合对象（用户信息）存储</p>
<table>
<thead>
<tr>
<th>命令</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td>hset key field value</td>
<td>添加</td>
</tr>
<tr>
<td>hget key field</td>
<td>获取</td>
</tr>
<tr>
<td>hmset key field value [field value]</td>
<td></td>
</tr>
<tr>
<td>hmget key field [field]</td>
<td></td>
</tr>
<tr>
<td>hgetall key</td>
<td>获取所有</td>
</tr>
<tr>
<td>hdel key field</td>
<td>删除</td>
</tr>
<tr>
<td>hlen</td>
<td>长度</td>
</tr>
<tr>
<td>hexists key field</td>
<td>判断</td>
</tr>
<tr>
<td>hkeys/hvalues key</td>
<td>获取键值</td>
</tr>
<tr>
<td>hincr key field</td>
<td></td>
</tr>
<tr>
<td>hincrby key field n</td>
<td></td>
</tr>
<tr>
<td>hsetnx key field value</td>
<td>不存在则添加</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<h2 id="2-7-有序集合zset"><a href="#2-7-有序集合zset" class="headerlink" title="2.7 有序集合zset"></a>2.7 有序集合zset</h2><p>在set上添加排序，排行榜</p>
<table>
<thead>
<tr>
<th>命令</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td>zadd key score value [score value]</td>
<td></td>
</tr>
<tr>
<td>zrange key begin end</td>
<td>获取所有</td>
</tr>
<tr>
<td>zrangebyscore key min max 【withscores】</td>
<td>排序 -inf无穷小</td>
</tr>
<tr>
<td>zrerangebyscore key</td>
<td></td>
</tr>
<tr>
<td>zrem key value</td>
<td>删除</td>
</tr>
<tr>
<td>zcard keys</td>
<td>获取个数</td>
</tr>
<tr>
<td>zrerange  key 0 -1</td>
<td>从大到小排序</td>
</tr>
<tr>
<td>zcount key min max</td>
<td>获取指定区间的数量</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<h1 id="三、特殊的数据类型"><a href="#三、特殊的数据类型" class="headerlink" title="三、特殊的数据类型"></a>三、特殊的数据类型</h1><h2 id="3-1-geospatical地理位置"><a href="#3-1-geospatical地理位置" class="headerlink" title="3.1 geospatical地理位置"></a>3.1 geospatical地理位置</h2><p>朋友定位，附近的人，打车</p>
<p>zset，<code>zrange key 0 -1</code></p>
<p>zrem,<code>zrem key value</code></p>
<table>
<thead>
<tr>
<th>命令</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td>geoadd key value(经度、纬度、名称)</td>
<td></td>
</tr>
<tr>
<td>geopos key value [value]</td>
<td></td>
</tr>
<tr>
<td>geodist key value1 value2 单位(km/m/mi/ft)</td>
<td>两地距离</td>
</tr>
<tr>
<td>georadius key 经 纬 dist 单位 withdist[with coord] [count n]</td>
<td>点的半径范围内的</td>
</tr>
<tr>
<td>georadiusbymember key value dist 单位(km/m/mi/ft)</td>
<td>城市半径范围内的</td>
</tr>
<tr>
<td>geohash key  value[value]</td>
<td>将经纬度转换为字符串</td>
</tr>
</tbody></table>
<h2 id="3-2-hyperloglog"><a href="#3-2-hyperloglog" class="headerlink" title="3.2 hyperloglog"></a>3.2 hyperloglog</h2><p>目的，计数，0.81%的错误率,12kb</p>
<table>
<thead>
<tr>
<th>命令</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td>pfadd key value [value]</td>
<td></td>
</tr>
<tr>
<td>pfcount key</td>
<td></td>
</tr>
<tr>
<td>pfmerge newkey key1 key2</td>
<td>合并不同的</td>
</tr>
</tbody></table>
<h2 id="3-3-bitmaps"><a href="#3-3-bitmaps" class="headerlink" title="3.3 bitmaps"></a>3.3 bitmaps</h2><p>位存储</p>
<p>打卡</p>
<table>
<thead>
<tr>
<th>命令</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td>setbit key offset value</td>
<td></td>
</tr>
<tr>
<td>getbit key offset</td>
<td></td>
</tr>
<tr>
<td>bitcount key [start end]</td>
<td></td>
</tr>
</tbody></table>
<h1 id="四、事务"><a href="#四、事务" class="headerlink" title="四、事务"></a>四、事务</h1><p> ACID：原子性，一致性，隔离性，持久性</p>
<p><strong>redis单条命令原子，事务不保证原子，redis事务没有隔离级别的概念</strong></p>
<p>事务：一组命令的集合，一个事务的命令都会被序列化，在执行过程中，会顺序执行</p>
<p>redis事务</p>
<ul>
<li><p>开启事务(<code>multi</code>)</p>
</li>
<li><p>命令入队()</p>
</li>
<li><p>执行事务(<code>exec</code>)</p>
</li>
<li><p>放弃事务(<code>discard</code>)</p>
</li>
</ul>
<p>编译错误，全部不执行，部分错误，接着执行</p>
<h1 id="五、锁"><a href="#五、锁" class="headerlink" title="五、锁"></a>五、锁</h1><h2 id="5-1-悲观锁"><a href="#5-1-悲观锁" class="headerlink" title="5.1 悲观锁"></a>5.1 悲观锁</h2><p>全部加锁</p>
<h2 id="5-2-乐观锁"><a href="#5-2-乐观锁" class="headerlink" title="5.2 乐观锁"></a>5.2 乐观锁</h2><ul>
<li><p>不上锁，更新数据时判断是否有人修改过该数据</p>
</li>
<li><p>获取version</p>
</li>
<li><p>更新时比较version</p>
</li>
</ul>
<h2 id="5-3-监视"><a href="#5-3-监视" class="headerlink" title="5.3 监视"></a>5.3 监视</h2><p><code>watch key</code> 使用watch当做乐观锁操作，运行完之前，key的值被修改了就会失败</p>
<p><code>multi</code></p>
<p><code>exec</code></p>
<p><code>unwatch</code></p>
<p>事务运行失败后先unwatch重新运行</p>
<h1 id="六、jedis"><a href="#六、jedis" class="headerlink" title="六、jedis"></a>六、jedis</h1><p>官方推荐java操作redis</p>
<p>空项目–》meaven</p>
<h2 id="6-1-修改3个java版本8"><a href="#6-1-修改3个java版本8" class="headerlink" title="6.1 修改3个java版本8"></a>6.1 修改3个java版本8</h2><p><img src="http://yanxuan.nosdn.127.net/791c20e8486551decfffe76e170f6b2e.png" alt="UTOOLS1589020739879.png" loading="lazy"></p>
<p><img src="http://yanxuan.nosdn.127.net/aa83e6dd296160c24d70d4c8d3f07ec6.png" alt="UTOOLS1589020765443.png" loading="lazy"></p>
<p><img src="http://yanxuan.nosdn.127.net/5a613a94b6bfc5462795a88e02dbd167.png" alt="UTOOLS1589020792513.png" loading="lazy"></p>
<h2 id="6-2-导入jedis包"><a href="#6-2-导入jedis包" class="headerlink" title="6.2 导入jedis包"></a>6.2 导入jedis包</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/redis.clients/jedis --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>redis.clients<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jedis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--json--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.62<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="6-3-步骤"><a href="#6-3-步骤" class="headerlink" title="6.3 步骤"></a>6.3 步骤</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1. new jedis对象</span></span><br><span class="line">Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">"127.0.0.1"</span>, <span class="number">6379</span>);</span><br><span class="line"><span class="comment">//方法基本一致</span></span><br><span class="line">System.out.println(jedis.ping());</span><br><span class="line">jedis.close();</span><br></pre></td></tr></table></figure>

<h2 id="6-4-常用API"><a href="#6-4-常用API" class="headerlink" title="6.4 常用API"></a>6.4 常用API</h2><p><code>String/List/Set/Hash/Zset</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ming;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.Jedis;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.Transaction;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestPing</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//1. new jedis对象</span></span><br><span class="line">        Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">"127.0.0.1"</span>, <span class="number">6379</span>);</span><br><span class="line">        jedis.flushDB();</span><br><span class="line">        JSONObject jsonObject = <span class="keyword">new</span> JSONObject();</span><br><span class="line">        jsonObject.put(<span class="string">"hello"</span>, <span class="string">"world"</span>);</span><br><span class="line">        jsonObject.put(<span class="string">"name"</span>, <span class="string">"mingming"</span>);</span><br><span class="line">        Transaction multi = jedis.multi();</span><br><span class="line">        String result = jsonObject.toJSONString();</span><br><span class="line">        jedis.watch(result);</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            multi.set(<span class="string">"user1"</span>, result);</span><br><span class="line">            multi.set(<span class="string">"user2"</span>, result);</span><br><span class="line">            multi.exec();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            multi.discard();</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">            System.out.println(jedis.get(<span class="string">"user1"</span>));</span><br><span class="line">            System.out.println(jedis.get(<span class="string">"user2"</span>));</span><br><span class="line">            System.out.println(jedis.ping());</span><br><span class="line">            jedis.close();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="七、Redis-conf"><a href="#七、Redis-conf" class="headerlink" title="七、Redis.conf"></a>七、Redis.conf</h1><ol>
<li><p>配置文件单位对大小写不敏感</p>
</li>
<li><p>包含.conf</p>
</li>
<li><p>网络</p>
<ol>
<li><code>bind 127.0.0.1</code>  绑定ip</li>
<li>protected-mode yes 保护模式</li>
<li><code>port 6379</code> 端口</li>
</ol>
</li>
</ol>
<h2 id="7-1-通用"><a href="#7-1-通用" class="headerlink" title="7.1 通用"></a>7.1 通用</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">daemonize yes <span class="comment">#以守护进程方式运行，默认为no</span></span><br><span class="line"></span><br><span class="line">pidfile /var/run/redis_6379.pid <span class="comment">#以后台方式运行，需要指定pid文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#日志</span></span><br><span class="line"><span class="comment"># Specify the server verbosity level.</span></span><br><span class="line"><span class="comment"># This can be one of:</span></span><br><span class="line"><span class="comment"># debug (a lot of information, useful for development/testing)</span></span><br><span class="line"><span class="comment"># verbose (many rarely useful info, but not a mess like the debug level)</span></span><br><span class="line"><span class="comment"># notice (moderately verbose, what you want in production probably)</span></span><br><span class="line"><span class="comment"># warning (only very important / critical messages are logged)</span></span><br><span class="line">loglevel notice</span><br><span class="line">logfile <span class="string">""</span> <span class="comment">#日志文件位置名</span></span><br><span class="line">databases 16</span><br><span class="line">always-show-logo yes</span><br></pre></td></tr></table></figure>

<h2 id="7-2-快照"><a href="#7-2-快照" class="headerlink" title="7.2 快照"></a>7.2 快照</h2><p>持久化，在规定时间内自行了多少次操作则会持久化到文件 <code>.rdb rdf</code></p>
<p>redis是内存数据库，如果没有数据库，断电即失</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">save 900 1  <span class="comment"># 900s内，有一个key进行了修改，则进行持久化</span></span><br><span class="line">save 300 10</span><br><span class="line">save 60 10000</span><br><span class="line"></span><br><span class="line">stop-writes-on-bgsave-error yes <span class="comment">#持久化如果出错，是否继续工作</span></span><br><span class="line"></span><br><span class="line">rdbcompression yes <span class="comment">#是否压缩rdb文件，消耗CPU资源</span></span><br><span class="line"></span><br><span class="line">rdbchecksum yes <span class="comment">#保存rdb文件时，进行错误检查</span></span><br><span class="line"></span><br><span class="line">dir  ./ <span class="comment">#rdb 文件保存的目录</span></span><br></pre></td></tr></table></figure>



<h2 id="7-3-REPLICATION复制"><a href="#7-3-REPLICATION复制" class="headerlink" title="7.3 REPLICATION复制"></a>7.3 REPLICATION复制</h2><p>主从复制</p>
<h2 id="7-4-sercurity"><a href="#7-4-sercurity" class="headerlink" title="7.4 sercurity"></a>7.4 sercurity</h2><p><code>config get requirepass</code></p>
<p>配置文件 requirepass 123456</p>
<p><code>config set requirepass &quot;123456&quot;</code> 修改密码</p>
<p><code>auth 123456</code> 密码登录</p>
<h2 id="7-5-clients客户端"><a href="#7-5-clients客户端" class="headerlink" title="7.5 clients客户端"></a>7.5 clients客户端</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">maxclients 10000 <span class="comment">#设置最大连接客户端数量</span></span><br><span class="line"></span><br><span class="line">maxmemory &lt;bytes&gt; <span class="comment">#redis配置的最大内存</span></span><br><span class="line"></span><br><span class="line">maxmemory-policy noeviction <span class="comment">#内存到达上限之后的处理策略</span></span><br></pre></td></tr></table></figure>

<p><img src="http://yanxuan.nosdn.127.net/1d3f87e5e57761beaf11e42e1fcf64d5.png" alt="UTOOLS1589025706947.png" loading="lazy"></p>
<h2 id="7-5-append-only-模式-aof配置"><a href="#7-5-append-only-模式-aof配置" class="headerlink" title="7.5 append only 模式 aof配置"></a>7.5 append only 模式 aof配置</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">appenonly no <span class="comment">#默认不开启，默认使用rdp方式持久化，rdb够用了</span></span><br><span class="line">appendfilename <span class="string">"appendonly.aof"</span> <span class="comment">#持久化文件的名字</span></span><br></pre></td></tr></table></figure>

<p><img src="http://yanxuan.nosdn.127.net/da63481b0f82a0d0c3d0d1764922ee51.png" alt="image-20200509200554745.png" loading="lazy"></p>
<h1 id="八、redis持久化"><a href="#八、redis持久化" class="headerlink" title="八、redis持久化"></a>八、redis持久化</h1><p><img src="http://yanxuan.nosdn.127.net/67292387a65c64bc0909fd6b74bafc13.png" alt="UTOOLS1589027964664.png" loading="lazy"></p>
<h2 id="8-1-RDB"><a href="#8-1-RDB" class="headerlink" title="8.1 RDB"></a>8.1 RDB</h2><p>rdb 保存的文件是<code>dump.rdb</code></p>
<p><strong>触发机制</strong></p>
<ol>
<li>save规则满足的情况下，触发rdb规则</li>
<li>flushall命令，会产生rdb文件</li>
<li>退出redis也会产生rdb文件</li>
</ol>
<p><strong>备份恢复</strong></p>
<p>rdb文件放到redis启动目录，启动即可</p>
<p><code>config get dir</code> 获取启动目录</p>
<p>默认的配置够用</p>
<p><strong>优点</strong>：</p>
<ol>
<li><p>适合大规模的数据恢复！dump.db</p>
<ol start="2">
<li>对数据完整性不高</li>
</ol>
</li>
</ol>
<p><strong>缺点</strong>：</p>
<ol>
<li>需要一定时间间隔，意外宕机，最后一次修改的数据没有了</li>
<li>fork进程时，会占用一定的内存空间</li>
</ol>
<h2 id="8-2-AOF"><a href="#8-2-AOF" class="headerlink" title="8.2 AOF"></a>8.2 AOF</h2><p>append only file</p>
<p>将所有命令记录下来</p>
<p><img src="http://yanxuan.nosdn.127.net/0f22cfa9ccd8b649b58a74941a520811.png" alt="UTOOLS1589028219014.png" loading="lazy"></p>
<p>开启AOF <code>appendonly yes</code></p>
<p><code>shutdown</code> </p>
<p><code>redis-check-aof --fix appendonly.aof</code> 修复aof文件</p>
<p><strong>优点</strong></p>
<ol>
<li>每次修改都同步，文件完整性好</li>
<li>每秒同步一次，可能丢失一秒的数据</li>
<li>从不同步，效率最高</li>
</ol>
<p><strong>缺点：</strong></p>
<ol>
<li>aof远远大于rdb，修复速度慢</li>
<li>运行效率慢</li>
</ol>
<h1 id="九、发布订阅"><a href="#九、发布订阅" class="headerlink" title="九、发布订阅"></a>九、发布订阅</h1><ol>
<li>实时信息订阅</li>
<li>实时聊天</li>
<li>订阅、关注</li>
<li>复杂就用消息中间件MQ</li>
</ol>
<p>Redis 发布订阅(pub/sub)是一种消息通信模式：发送者(pub)发送消息，订阅者(sub)接收消息。</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2014/11/pubsub1.png" alt="img" loading="lazy"></p>
<p>当有新消息通过 PUBLISH 命令发送给频道 channel1 时， 这个消息就会被发送给订阅它的三个客户端：</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2014/11/pubsub2.png" alt="img" loading="lazy"></p>
<table>
<thead>
<tr>
<th>命令</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>subscribe channel [channel]</td>
<td><strong>订阅</strong>给定的一个或多个频道的信息</td>
</tr>
<tr>
<td>publish channel message</td>
<td>将信息<strong>发送</strong>到指定的频道</td>
</tr>
<tr>
<td>psubscribe pattern [pattern]</td>
<td>订阅一个或多个给定模式的频道</td>
</tr>
<tr>
<td>pubsub subcommand [argument [argument …]]</td>
<td>查看订阅与发布系统状态</td>
</tr>
<tr>
<td>unsubscribe [channel] [channel]</td>
<td>退订给定的频道</td>
</tr>
<tr>
<td>punsubscribe [pattern [pattern …]]</td>
<td>退订为定模式的频道</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>例子</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">subscribe mingyue   <span class="comment">#订阅</span></span><br><span class="line"></span><br><span class="line">publish mingyue <span class="string">"i love you"</span>  <span class="comment">#发布</span></span><br></pre></td></tr></table></figure>

<p><img src="http://yanxuan.nosdn.127.net/0bdc46ad850fab3f2caac4ae0e3df087.png" alt="UTOOLS1589034850649.png" loading="lazy"></p>
<h1 id="十、主从复制"><a href="#十、主从复制" class="headerlink" title="十、主从复制"></a>十、主从复制</h1><p>将一台redis服务器的数据复制到其他的redis服务器，前者为主节点（master/leader)，后者为从节点，数据复制是单向的，只能又主节点到从节点，master以写为主，slave以读为主。</p>
<p>主从复制，读写分离，百分之八十都是读操作！减轻服务器压力，架构中经常使用，一组二从</p>
<p><strong>默认情况下每一台redis都是主节点</strong> </p>
<p><strong>主从复制的作用：</strong></p>
<ol>
<li>数据冗余：实现了数据的热备份，是持久化外的一种数据冗余方式</li>
<li>故障恢复：当主节点出现问题时，可由节点提供服务，实现快速的故障恢复，实际上是一种服务的冗余</li>
<li>负载均衡：在主从复制的基础上，配合读写分离，可由主节点提供服务，由节点提供读服务（写redis数据连接自主节点，读连接从节点），分担服务器负载；尤其在写少读多的场景下，通过多个从节点分担负载，可以大大提高redis服务器的并发量</li>
<li>高可用（集群）基石）：主从复制还是哨兵和集群能够实施的基础，因此说主从复制的redis高可用的基础</li>
</ol>
<p>运用于redis运用于工程项目，只用一台不够（宕机）</p>
<ol>
<li>结构上：单个redis服务器会发生单点故障，并且一台服务器需要处理所有的请求负载，压力大</li>
<li>容量上：单个redis服务器内存容量有限，就算一台redis服务器内存容量为256G，也不能将所有内存用作redis存储内存，单台redis最大内存不应该超过20G</li>
</ol>
<p>电商：一次上传，无数次浏览，多读少写</p>
<p><code>info replication</code> 查看当前库的信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Replication</span></span><br><span class="line">role:master</span><br><span class="line">connected_slaves:0</span><br><span class="line">master_replid:3232a49ef723168b5f6a5dd04a51734e4edc9719</span><br><span class="line">master_replid2:0000000000000000000000000000000000000000</span><br><span class="line">master_repl_offset:0</span><br><span class="line">second_repl_offset:-1</span><br><span class="line">repl_backlog_active:0</span><br><span class="line">repl_backlog_size:1048576</span><br><span class="line">repl_backlog_first_byte_offset:0</span><br><span class="line">repl_backlog_histlen:</span><br></pre></td></tr></table></figure>



<h2 id="10-1-搭建集群"><a href="#10-1-搭建集群" class="headerlink" title="10.1 搭建集群"></a>10.1 搭建集群</h2><h3 id="配置3个配置文件"><a href="#配置3个配置文件" class="headerlink" title="配置3个配置文件"></a>配置3个配置文件</h3><p><strong>端口</strong></p>
<p><code>port 6380</code></p>
<p><strong>pid名字</strong></p>
<p><code>pidfile /var/run/redis_6380.pid</code></p>
<p><strong>log名字</strong></p>
<p><code>logfile “6379.log”</code></p>
<p><strong>备份名字</strong></p>
<p><code>dbfilename dump6379.rdb</code></p>
<h3 id="启动redis"><a href="#启动redis" class="headerlink" title="启动redis"></a>启动redis</h3><p><code>redis-server myConfig/redis79.conf</code></p>
<p><img src="http://yanxuan.nosdn.127.net/eac82fc26f08f814ad28ede1c1208cd5.png" alt="UTOOLS1589040422883.png" loading="lazy"></p>
<p><code>redis-cli -p 6379</code>连接</p>
<p><code>info repolication</code></p>
<h3 id="一组二从"><a href="#一组二从" class="headerlink" title="一组二从"></a>一组二从</h3><p>==默认情况下每一台redis都是主节点==，配置从机</p>
<p><code>slaveof 127.0.0.1 6379</code></p>
<p><code>info repolication</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Replication</span></span><br><span class="line">role:slave</span><br><span class="line">master_host:127.0.0.1</span><br><span class="line">master_port:6379</span><br><span class="line">master_link_status:up</span><br><span class="line">master_last_io_seconds_ago:8</span><br><span class="line">master_sync_in_progress:0</span><br><span class="line">slave_repl_offset:42</span><br><span class="line">slave_priority:100</span><br><span class="line">slave_read_only:1</span><br><span class="line">connected_slaves:0</span><br><span class="line">master_replid:575e2d5475971e481145a2211a7d98e52c67f4fe</span><br><span class="line">master_replid2:0000000000000000000000000000000000000000</span><br><span class="line">master_repl_offset:42</span><br><span class="line">second_repl_offset:-1</span><br><span class="line">repl_backlog_active:1</span><br><span class="line">repl_backlog_size:1048576</span><br><span class="line">repl_backlog_first_byte_offset:1</span><br><span class="line">repl_backlog_histlen:42</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; info replication</span><br><span class="line"><span class="comment"># Replication</span></span><br><span class="line">role:master</span><br><span class="line">connected_slaves:2</span><br><span class="line">slave0:ip=127.0.0.1,port=6380,state=online,offset=140,lag=1</span><br><span class="line">slave1:ip=127.0.0.1,port=6381,state=online,offset=140,lag=0</span><br><span class="line">master_replid:575e2d5475971e481145a2211a7d98e52c67f4fe</span><br><span class="line">master_replid2:0000000000000000000000000000000000000000</span><br><span class="line">master_repl_offset:140</span><br><span class="line">second_repl_offset:-1</span><br><span class="line">repl_backlog_active:1</span><br><span class="line">repl_backlog_size:1048576</span><br><span class="line">repl_backlog_first_byte_offset:1</span><br><span class="line">repl_backlog_histlen:140</span><br></pre></td></tr></table></figure>

<p>应该在配置文件中配置才是永久的</p>
<p><strong>conf</strong></p>
<p><code>replication &lt;masterip&gt; &lt;masterport&gt;</code></p>
<p><code>masterauth &lt;master-password&gt;</code></p>
<p>主机才能写，从机只能读</p>
<p><strong>断开连接</strong></p>
<p>主机断开，从机没有写能力，恢复了才能继续</p>
<p>从机断开，使用的是命令配置，重启后变成了主机，主机新的信息无法更新，只要变成从机，就能恢复数据</p>
<h3 id="复制原理"><a href="#复制原理" class="headerlink" title="复制原理"></a>复制原理</h3><p>slave启动成功连接到master后发送一个sync同步命令</p>
<p>master接到命令，启动后台的存盘进程，同时收集所有接收到用于修改数据集命令，在后台进程执行完毕后，<strong>master将传送整个数据文件到slave，并完成一次完全同步</strong></p>
<p><strong>全量复制</strong>：slave服务在接收到数据库文件数据后，将其存盘并加载到内存中</p>
<p><strong>增量复制</strong>：master继续将新的所有收集到的修改命令一次传给slave，完成同步</p>
<p>只要重新连接master，全量复制将被执行</p>
<ul>
<li><p><strong>一主二从</strong></p>
</li>
<li><p><strong>层层链路</strong></p>
<ul>
<li><code>slaveof no one</code> 主机断开连接，使自己变成主机</li>
</ul>
</li>
</ul>
<h2 id="10-1-哨兵模式"><a href="#10-1-哨兵模式" class="headerlink" title="10.1 哨兵模式"></a>10.1 哨兵模式</h2><p>自动选取主机，sentinel(哨兵)</p>
<p>原理：哨兵通过发送命令，等待redis服务器响应，从而监控运行的多个redis实例</p>
<h3 id="哨兵配置"><a href="#哨兵配置" class="headerlink" title="哨兵配置"></a>哨兵配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim sentinel.conf</span><br><span class="line">                <span class="comment">#被监控的名称   host     port   投票</span></span><br><span class="line">sentinel monitor  myredis   127.0.0.1  6379    1</span><br></pre></td></tr></table></figure>

<p><strong>全部配置</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">port 26379</span><br><span class="line">dir /tmp</span><br><span class="line">sentinel monitor mymaster 127.0.0.1 6379 2</span><br><span class="line"><span class="comment">#有密码</span></span><br><span class="line">sentinel auth-pass mymaster MYSUPER--sercret 123passwOrd</span><br><span class="line"><span class="comment">#默认30秒改变</span></span><br><span class="line">sentinel down-after-millisenconds mymaster 30000</span><br></pre></td></tr></table></figure>

<p><img src="http://yanxuan.nosdn.127.net/9594af3f36783596e75207250891573b.png" alt="UTOOLS1589080559264.png" loading="lazy"></p>
<h3 id="启动哨兵"><a href="#启动哨兵" class="headerlink" title="启动哨兵"></a>启动哨兵</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-sentinel myConfig/sentinel.conf</span><br></pre></td></tr></table></figure>

<p>failover</p>
<p>主机挂了之后，哨兵</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">14231</span>:X <span class="number">10</span> May <span class="number">2020</span> <span class="number">10</span>:<span class="number">59</span>:<span class="number">45</span><span class="variable">.972</span> # WARNING: The TCP backlog setting of <span class="number">511</span> cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of <span class="number">128</span>.</span><br><span class="line"><span class="number">14231</span>:X <span class="number">10</span> May <span class="number">2020</span> <span class="number">10</span>:<span class="number">59</span>:<span class="number">45</span><span class="variable">.974</span> # Sentinel ID is <span class="number">966</span>f8534f576844c2d789f75bdadf0b87de7e1fd</span><br><span class="line"><span class="number">14231</span>:X <span class="number">10</span> May <span class="number">2020</span> <span class="number">10</span>:<span class="number">59</span>:<span class="number">45</span><span class="variable">.974</span> # +monitor master myredis <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6379</span> quorum <span class="number">1</span></span><br><span class="line"><span class="number">14231</span>:X <span class="number">10</span> May <span class="number">2020</span> <span class="number">10</span>:<span class="number">59</span>:<span class="number">45</span><span class="variable">.975</span> * +slave slave <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span>:<span class="number">6380</span> <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6380</span> @ myredis <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6379</span></span><br><span class="line"><span class="number">14231</span>:X <span class="number">10</span> May <span class="number">2020</span> <span class="number">10</span>:<span class="number">59</span>:<span class="number">45</span><span class="variable">.976</span> * +slave slave <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span>:<span class="number">6381</span> <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6381</span> @ myredis <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6379</span></span><br><span class="line"><span class="number">14231</span>:X <span class="number">10</span> May <span class="number">2020</span> <span class="number">11</span>:<span class="number">01</span>:<span class="number">21</span><span class="variable">.994</span> # +sdown master myredis <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6379</span></span><br><span class="line"><span class="number">14231</span>:X <span class="number">10</span> May <span class="number">2020</span> <span class="number">11</span>:<span class="number">01</span>:<span class="number">21</span><span class="variable">.994</span> # +odown master myredis <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6379</span> #quorum <span class="number">1</span>/<span class="number">1</span></span><br><span class="line"><span class="number">14231</span>:X <span class="number">10</span> May <span class="number">2020</span> <span class="number">11</span>:<span class="number">01</span>:<span class="number">21</span><span class="variable">.994</span> # +<span class="keyword">new</span>-epoch <span class="number">1</span></span><br><span class="line"><span class="number">14231</span>:X <span class="number">10</span> May <span class="number">2020</span> <span class="number">11</span>:<span class="number">01</span>:<span class="number">21</span><span class="variable">.994</span> # +try-failover master myredis <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6379</span></span><br><span class="line"><span class="number">14231</span>:X <span class="number">10</span> May <span class="number">2020</span> <span class="number">11</span>:<span class="number">01</span>:<span class="number">21</span><span class="variable">.996</span> # +vote-<span class="keyword">for</span>-leader <span class="number">966</span>f8534f576844c2d789f75bdadf0b87de7e1fd <span class="number">1</span></span><br><span class="line"><span class="number">14231</span>:X <span class="number">10</span> May <span class="number">2020</span> <span class="number">11</span>:<span class="number">01</span>:<span class="number">21</span><span class="variable">.996</span> # +elected-leader master myredis <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6379</span></span><br><span class="line"><span class="number">14231</span>:X <span class="number">10</span> May <span class="number">2020</span> <span class="number">11</span>:<span class="number">01</span>:<span class="number">21</span><span class="variable">.996</span> # +failover-state-select-slave master myredis <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6379</span></span><br><span class="line"><span class="number">14231</span>:X <span class="number">10</span> May <span class="number">2020</span> <span class="number">11</span>:<span class="number">01</span>:<span class="number">22</span><span class="variable">.086</span> # +selected-slave slave <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span>:<span class="number">6380</span> <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6380</span> @ myredis <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6379</span></span><br><span class="line"><span class="number">14231</span>:X <span class="number">10</span> May <span class="number">2020</span> <span class="number">11</span>:<span class="number">01</span>:<span class="number">22</span><span class="variable">.086</span> * +failover-state-send-slaveof-noone slave <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span>:<span class="number">6380</span> <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6380</span> @ myredis <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6379</span></span><br><span class="line"><span class="number">14231</span>:X <span class="number">10</span> May <span class="number">2020</span> <span class="number">11</span>:<span class="number">01</span>:<span class="number">22</span><span class="variable">.158</span> * +failover-state-<span class="keyword">wait</span>-promotion slave <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span>:<span class="number">6380</span> <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6380</span> @ myredis <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6379</span></span><br><span class="line"><span class="number">14231</span>:X <span class="number">10</span> May <span class="number">2020</span> <span class="number">11</span>:<span class="number">01</span>:<span class="number">23</span><span class="variable">.161</span> # +promoted-slave slave <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span>:<span class="number">6380</span> <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6380</span> @ myredis <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6379</span></span><br><span class="line"><span class="number">14231</span>:X <span class="number">10</span> May <span class="number">2020</span> <span class="number">11</span>:<span class="number">01</span>:<span class="number">23</span><span class="variable">.161</span> # +failover-state-reconf-slaves master myredis <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6379</span></span><br><span class="line"><span class="number">14231</span>:X <span class="number">10</span> May <span class="number">2020</span> <span class="number">11</span>:<span class="number">01</span>:<span class="number">23</span><span class="variable">.209</span> * +slave-reconf-sent slave <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span>:<span class="number">6381</span> <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6381</span> @ myredis <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6379</span></span><br><span class="line"><span class="number">14231</span>:X <span class="number">10</span> May <span class="number">2020</span> <span class="number">11</span>:<span class="number">01</span>:<span class="number">24</span><span class="variable">.201</span> * +slave-reconf-inprog slave <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span>:<span class="number">6381</span> <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6381</span> @ myredis <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6379</span></span><br><span class="line"><span class="number">14231</span>:X <span class="number">10</span> May <span class="number">2020</span> <span class="number">11</span>:<span class="number">01</span>:<span class="number">24</span><span class="variable">.201</span> * +slave-reconf-done slave <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span>:<span class="number">6381</span> <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6381</span> @ myredis <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6379</span></span><br><span class="line"><span class="number">14231</span>:X <span class="number">10</span> May <span class="number">2020</span> <span class="number">11</span>:<span class="number">01</span>:<span class="number">24</span><span class="variable">.283</span> # +failover-<span class="keyword">end</span> master myredis <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6379</span></span><br><span class="line"><span class="number">14231</span>:X <span class="number">10</span> May <span class="number">2020</span> <span class="number">11</span>:<span class="number">01</span>:<span class="number">24</span><span class="variable">.283</span> # +switch-master myredis <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6379</span> <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6380</span></span><br><span class="line"><span class="number">14231</span>:X <span class="number">10</span> May <span class="number">2020</span> <span class="number">11</span>:<span class="number">01</span>:<span class="number">24</span><span class="variable">.283</span> * +slave slave <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span>:<span class="number">6381</span> <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6381</span> @ myredis <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6380</span></span><br><span class="line"><span class="number">14231</span>:X <span class="number">10</span> May <span class="number">2020</span> <span class="number">11</span>:<span class="number">01</span>:<span class="number">24</span><span class="variable">.283</span> * +slave slave <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span>:<span class="number">6379</span> <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6379</span> @ myredis <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6380</span></span><br><span class="line"></span><br><span class="line">#复活后</span><br><span class="line"><span class="number">14231</span>:X <span class="number">10</span> May <span class="number">2020</span> <span class="number">11</span>:<span class="number">04</span>:<span class="number">32</span><span class="variable">.915</span> * +convert-to-slave slave <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span>:<span class="number">6379</span> <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6379</span> @ myredis <span class="number">127</span><span class="variable">.0</span><span class="variable">.0</span><span class="variable">.1</span> <span class="number">6380</span></span><br></pre></td></tr></table></figure>

<p><strong>优点</strong></p>
<ol>
<li>基于主从配置，自动配置</li>
<li>主从可以切换，故障可以转移，可用性好</li>
</ol>
<p><strong>缺点</strong></p>
<ol>
<li>不方便在线扩容</li>
<li>哨兵模式的配置很麻烦</li>
</ol>
<h1 id="十一、缓存穿透和雪崩"><a href="#十一、缓存穿透和雪崩" class="headerlink" title="十一、缓存穿透和雪崩"></a>十一、缓存穿透和雪崩</h1>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://mingyuefusu.github.io/2020/05/14/redis/" data-id="cka6j0rcl0001gwi58i1ybtse" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-明月复苏" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/05/14/%E6%98%8E%E6%9C%88%E5%A4%8D%E8%8B%8F/" class="article-date">
  <time datetime="2020-05-14T08:13:41.812Z" itemprop="datePublished">2020-05-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/05/14/%E6%98%8E%E6%9C%88%E5%A4%8D%E8%8B%8F/">明月复苏</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="hello"><a href="#hello" class="headerlink" title="hello"></a>hello</h1><p><code>我爱学习，学习爱我</code></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://mingyuefusu.github.io/2020/05/14/%E6%98%8E%E6%9C%88%E5%A4%8D%E8%8B%8F/" data-id="cka6hyob20000f8i5ad223byb" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/05/14/jsp/">jsp</a>
          </li>
        
          <li>
            <a href="/2020/05/14/docker/">docker</a>
          </li>
        
          <li>
            <a href="/2020/05/14/redis/">redis</a>
          </li>
        
          <li>
            <a href="/2020/05/14/%E6%98%8E%E6%9C%88%E5%A4%8D%E8%8B%8F/">明月复苏</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 mingyue<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>